//DirectShow tuner/broadcast


//bdatypes.h

typedef struct BDA_TEMPLATE_CONNECTION
{
    ULONG   FromNodeType;
    ULONG   FromNodePinType;
    ULONG   ToNodeType;
    ULONG   ToNodePinType;
}BDA_TEMPLATE_CONNECTION;


typedef struct BDA_TEMPLATE_PIN_JOINT
{
    ULONG   uliTemplateConnection;
    ULONG   ulcInstancesMax;
}BDA_TEMPLATE_PIN_JOINT;



//===========================================================================
//
//  BDA Events
//
//===========================================================================

//  In-band Event IDs
//
typedef enum BDA_EVENT_ID {
    BDA_EVENT_SIGNAL_LOSS = 0,
    BDA_EVENT_SIGNAL_LOCK,
    BDA_EVENT_DATA_START,
    BDA_EVENT_DATA_STOP,
    BDA_EVENT_CHANNEL_ACQUIRED,
    BDA_EVENT_CHANNEL_LOST,
    BDA_EVENT_CHANNEL_SOURCE_CHANGED,
    BDA_EVENT_CHANNEL_ACTIVATED,
    BDA_EVENT_CHANNEL_DEACTIVATED,
    BDA_EVENT_SUBCHANNEL_ACQUIRED,
    BDA_EVENT_SUBCHANNEL_LOST,
    BDA_EVENT_SUBCHANNEL_SOURCE_CHANGED,
    BDA_EVENT_SUBCHANNEL_ACTIVATED,
    BDA_EVENT_SUBCHANNEL_DEACTIVATED,
    BDA_EVENT_ACCESS_GRANTED,
    BDA_EVENT_ACCESS_DENIED,
    BDA_EVENT_OFFER_EXTENDED,
    BDA_EVENT_PURCHASE_COMPLETED,
    BDA_EVENT_SMART_CARD_INSERTED,
    BDA_EVENT_SMART_CARD_REMOVED
} BDA_EVENT_ID;



//===========================================================================
//
//  KSSTREAM_HEADER extensions for BDA
//
//===========================================================================

//#ifndef MANAGED_ENUMS
typedef struct KS_BDA_FRAME_INFO {
    ULONG                   ExtendedHeaderSize; // Size of this extended header
    DWORD                   dwFrameFlags;  //
    ULONG                   ulEvent; //
    ULONG                   ulChannelNumber; //
    ULONG                   ulSubchannelNumber; //
    ULONG                   ulReason; //
} KS_BDA_FRAME_INFO;


//------------------------------------------------------------
//
//  BDA Network Ethernet Filter Property Set
//
// {71985F43-1CA1-11d3-9CC8-00C04F7971E0}
//
typedef struct BDA_ETHERNET_ADDRESS {
    BYTE    rgbAddress[6];
} BDA_ETHERNET_ADDRESS;

typedef struct BDA_ETHERNET_ADDRESS_LIST {
    ULONG               ulcAddresses;
    BDA_ETHERNET_ADDRESS    rgAddressl[1];
} BDA_ETHERNET_ADDRESS_LIST;

//#endif

typedef enum BDA_MULTICAST_MODE {
    BDA_PROMISCUOUS_MULTICAST = 0,
    BDA_FILTERED_MULTICAST,
    BDA_NO_MULTICAST
} BDA_MULTICAST_MODE;


//------------------------------------------------------------
//
//  BDA Network IPv4 Filter Property Set
//
// {71985F44-1CA1-11d3-9CC8-00C04F7971E0}
//
//#ifndef MANAGED_ENUMS
typedef struct BDA_IPv4_ADDRESS {
    BYTE    rgbAddress[4];
} BDA_IPv4_ADDRESS;

typedef struct BDA_IPv4_ADDRESS_LIST {
    ULONG               ulcAddresses;
    BDA_IPv4_ADDRESS    rgAddressl[1];
} BDA_IPv4_ADDRESS_LIST;

//------------------------------------------------------------
//
//  BDA Network IPv4 Filter Property Set
//
// {E1785A74-2A23-4fb3-9245-A8F88017EF33}
//
typedef struct BDA_IPv6_ADDRESS {
    BYTE    rgbAddress[6];
} BDA_IPv6_ADDRESS;

typedef struct BDA_IPv6_ADDRESS_LIST {
    ULONG               ulcAddresses;
    BDA_IPv6_ADDRESS    rgAddressl[1];
} BDA_IPv6_ADDRESS_LIST;

//#endif


//------------------------------------------------------------
//
//
//  BDA Signal Property Set
//
//  {D2F1644B-B409-11d2-BC69-00A0C9EE9E16}
//
typedef enum BDA_SIGNAL_STATE {
    BDA_SIGNAL_UNAVAILABLE = 0,
    BDA_SIGNAL_INACTIVE,
    BDA_SIGNAL_ACTIVE
} BDA_SIGNAL_STATE;


//------------------------------------------------------------
//
//
//  BDA Change Sync Method Set
//
// {FD0A5AF3-B41D-11d2-9C95-00C04F7971E0}
//
typedef enum BDA_CHANGE_STATE {
    BDA_CHANGES_COMPLETE = 0,
    BDA_CHANGES_PENDING
} BDA_CHANGE_STATE;


//------------------------------------------------------------
//
//
//  BDA Device Configuration Method Set
//
// {71985F45-1CA1-11d3-9CC8-00C04F7971E0}
//


//------------------------------------------------------------
//
//
//  BDA Topology Property Set
//
// {A14EE835-0A23-11d3-9CC7-00C04F7971E0}
//

typedef struct BDANODE_DESCRIPTOR
{
    ULONG               ulBdaNodeType;  // The node type as it is used
    // in the BDA template topology

    UUID                guidFunction;   // GUID from BdaMedia.h describing
    // the node's function (e.g.
    // KSNODE_BDA_RF_TUNER)

    UUID                guidName;       // GUID that can be use to look up
    // a displayable name for the node.
} BDANODE_DESCRIPTOR;


//------------------------------------------------------------
//
//
//  BDA Void Transform Property Set
//
// {71985F46-1CA1-11d3-9CC8-00C04F7971E0}
//


//------------------------------------------------------------
//
//
//  BDA Null Transform Property Set
//
// {DDF15B0D-BD25-11d2-9CA0-00C04F7971E0}
//


//------------------------------------------------------------
//
//
//  BDA Frequency Filter Property Set
//
// {71985F47-1CA1-11d3-9CC8-00C04F7971E0}
//


//------------------------------------------------------------
//
//
//  BDA Autodemodulate Property Set
//
// {DDF15B12-BD25-11d2-9CA0-00C04F7971E0}
//


//------------------------------------------------------------
//
//
//  BDA Table Section Property Set
//
// {516B99C5-971C-4aaf-B3F3-D9FDA8A15E16}
//

typedef struct BDA_TABLE_SECTION
{
    ULONG               ulPrimarySectionId;
    ULONG               ulSecondarySectionId;
    ULONG               ulcbSectionLength;
    ULONG               argbSectionData[1];
} BDA_TABLE_SECTION;

//------------------------------------------------------------
//
//
//  BDA Diseq Command Property Set
//
// {F84E2AB0-3C6B-45e3-A0FC-8669D4B81F11}
//

typedef struct BDA_DISEQC_SEND
{
    ULONG   ulRequestId;
    ULONG   ulPacketLength;
    BYTE    argbPacketData[8];
} BDA_DISEQC_SEND;

typedef struct BDA_DISEQC_RESPONSE
{
    ULONG   ulRequestId;
    ULONG   ulPacketLength;
    BYTE    argbPacketData[8];
} BDA_DISEQC_RESPONSE;



//------------------------------------------------------------
//
//
//  BDA PID Filter Property Set
//
// {D0A67D65-08DF-4fec-8533-E5B550410B85}
//

//---------------------------------------------------------------------
// From IEnumPIDMap interface
//---------------------------------------------------------------------

typedef enum MEDIA_SAMPLE_CONTENT {
    MEDIA_TRANSPORT_PACKET,         //  complete TS packet e.g. pass-through mode
    MEDIA_ELEMENTARY_STREAM,        //  PES payloads; audio/video only
    MEDIA_MPEG2_PSI,                //  PAT, PMT, CAT, Private
    MEDIA_TRANSPORT_PAYLOAD         //  gathered TS packet payloads (PES packets, etc...)
} MEDIA_SAMPLE_CONTENT;

typedef struct {
    ULONG                   ulPID;
    MEDIA_SAMPLE_CONTENT    MediaSampleContent;
} PID_MAP;

typedef struct BDA_PID_MAP
{
    MEDIA_SAMPLE_CONTENT    MediaSampleContent;
    ULONG                   ulcPIDs;
    ULONG                   aulPIDs[1];
} BDA_PID_MAP;

typedef struct BDA_PID_UNMAP
{
    ULONG               ulcPIDs;
    ULONG               aulPIDs[1];
} BDA_PID_UNMAP;


//------------------------------------------------------------
//
//
//  BDA CA Property Set
//
// {B0693766-5278-4ec6-B9E1-3CE40560EF5A}
//
typedef struct BDA_CA_MODULE_UI
{
    ULONG   ulFormat;
    ULONG   ulbcDesc;
    ULONG   ulDesc[1];
} BDA_CA_MODULE_UI;

typedef struct BDA_PROGRAM_PID_LIST
{
    ULONG   ulProgramNumber;
    ULONG   ulcPIDs;
    ULONG   ulPID[1];
} BDA_PROGRAM_PID_LIST;


//------------------------------------------------------------
//
//
//  BDA CA Event Set
//
// {488C4CCC-B768-4129-8EB1-B00A071F9068}
//

//=============================================================
// PBDA RESULT parameter definition 
//=============================================================
typedef LONG PBDARESULT;

//=============================================================
//  BDA_DRM_STATUS used by the DRMService
//=============================================================

typedef struct BDA_DRM_DRMSTATUS
{
    PBDARESULT lResult;
    UUID    DRMuuid;
    ULONG   ulDrmUuidListStringSize;
    UUID    argbDrmUuidListString[1];
} BDA_DRM_DRMSTATUS;


//=============================================================
// PBDA_WMDRM and PBDA_WMDRMTuner structures 
//=============================================================

typedef struct BDA_WMDRM_STATUS
{
    PBDARESULT lResult;
    ULONG      ulMaxCaptureTokenSize;
    ULONG      uMaxStreamingPid;
    ULONG      ulMaxLicense;
    ULONG      ulMinSecurityLevel;
    ULONG      ulRevInfoSequenceNumber;
    ULONGLONG  ulRevInfoIssuedTime;
    ULONG      ulRevListVersion;
    ULONG      ulRevInfoTTL;
    ULONG      ulState;
} BDA_WMDRM_STATUS;

typedef struct BDA_WMDRM_KEYINFOLIST
{
    PBDARESULT  lResult;
    ULONG       ulKeyuuidBufferLen;
    UUID        argKeyuuidBuffer[1];
} BDA_WMDRM_KEYINFOLIST;

typedef struct BDA_BUFFER
{
    PBDARESULT  lResult;
    ULONG       ulBufferSize;
    BYTE        argbBuffer[1];
} BDA_BUFFER;

//=============================================================
// PBDA - DRM structures used in methods
//=============================================================

typedef struct BDA_WMDRM_RENEWLICENSE
{
    PBDARESULT  lResult;
    ULONG       ulDescrambleStatus;
    ULONG       ulXmrLicenseOutputLength;
    BYTE        argbXmrLicenceOutputBuffer[1]; //License and Entitlement Token Buffer 
} BDA_WMDRM_RENEWLICENSE;

typedef struct BDA_WMDRMTUNER_PIDPROTECTION
{
    PBDARESULT  lResult;
    UUID        uuidKeyID;
} BDA_WMDRMTUNER_PIDPROTECTION;

typedef struct BDA_WMDRMTUNER_PURCHASEENTITLEMENT
{
    PBDARESULT  lResult;
    ULONG       ulDescrambleStatus;
    ULONG       ulCaptureTokenLength;
    BYTE        argbCaptureTokenBuffer[1];
} BDA_WMDRMTUNER_PURCHASEENTITLEMENT;

//=============================================================
// PBDA - TUNER structures used in methods
//=============================================================

typedef struct BDA_TUNER_TUNERSTATE {
    PBDARESULT  lResult;
    ULONG       ulTuneLength;
    BYTE        argbTuneData[1];
} BDA_TUNER_TUNERSTATE;

typedef struct BDA_TUNER_DIAGNOSTICS {
    PBDARESULT  lResult;
    ULONG       ulSignalLevel;
    ULONG       ulSignalLevelQuality;
    ULONG       ulSignalNoiseRatio;
} BDA_TUNER_DIAGNOSTICS;

//=============================================================
// PBDA - STRING structure used in methods
//=============================================================

typedef struct BDA_STRING
{
    PBDARESULT  lResult;
    ULONG       ulStringSize;
    BYTE        argbString[1];
} BDA_STRING;


//=============================================================
// PBDA - SCANNING structures used in methods
//=============================================================

typedef struct BDA_SCAN_CAPABILTIES
{
    PBDARESULT  lResult;
    UINT64      ul64AnalogStandardsSupported;
} BDA_SCAN_CAPABILTIES;

typedef struct BDA_SCAN_STATE
{
    PBDARESULT  lResult;
    ULONG       ulSignalLock;
    ULONG       ulSecondsLeft;
    ULONG       ulCurrentFrequency;
} BDA_SCAN_STATE;

typedef struct BDA_SCAN_START
{
    PBDARESULT  lResult;
    ULONG       LowerFrequency;
    ULONG       HigerFrequency;
} BDA_SCAN_START;


//=============================================================
// PBDA - GUIDE DATA structures used in methods
//=============================================================

typedef struct BDA_GDDS_DATATYPE
{
    PBDARESULT  lResult;
    UUID        uuidDataType;
} BDA_GDDS_DATATYPE;

typedef struct BDA_GDDS_DATA
{
    PBDARESULT  lResult;
    ULONG       ulDataLength;
    ULONG       ulPercentageProgress;
    BYTE        argbData[1];
} BDA_GDDS_DATA;


//=============================================================
// PBDA - USER ACTIVITY structures used in methods
//=============================================================

typedef struct BDA_USERACTIVITY_INTERVAL
{
    PBDARESULT  lResult;
    ULONG       ulActivityInterval;
} BDA_USERACTIVITY_INTERVAL;


//=============================================================
// PBDA - CAS structures used in methods
//=============================================================

typedef struct BDA_CAS_CHECK_ENTITLEMENTTOKEN
{
    PBDARESULT  lResult;
    ULONG       ulDescrambleStatus;
} BDA_CAS_CHECK_ENTITLEMENTTOKEN;

typedef struct BDA_CAS_CLOSE_MMIDIALOG
{
    PBDARESULT  lResult;
    ULONG       SessionResult;
} BDA_CAS_CLOSE_MMIDIALOG;

typedef struct BDA_CAS_REQUESTTUNERDATA
{
    UCHAR       ucRequestPriority;
    UCHAR       ucRequestReason;
    UCHAR       ucRequestConsequences;
    ULONG       ulEstimatedTime;
} BDA_CAS_REQUESTTUNERDATA;

typedef struct BDA_CAS_OPENMMIDATA
{
    ULONG       ulDialogNumber;
    ULONG       ulDialogRequest;
    UUID        uuidDialogType;
    USHORT      usDialogDataLength;
    BYTE        argbDialogData[1];
} BDA_CAS_OPENMMIDATA;

typedef struct BDA_CAS_CLOSEMMIDATA
{
    ULONG       ulDialogNumber;
} BDA_CAS_CLOSEMMIDATA;

//=============================================================
// PBDA - ISDB CAS structures used in methods
//=============================================================


typedef enum ISDBCAS_REQUEST_ID {
    ISDBCAS_REQUEST_ID_EMG = 0x38,
    ISDBCAS_REQUEST_ID_EMD = 0x3A,
} ISDBCAS_REQUEST_ID;
#pragma pack(push, 1)

typedef struct BDA_ISDBCAS_REQUESTHEADER
{
    BYTE        bInstruction;                   // EMD/EMG
    BYTE        bReserved[3];                   // future use
    ULONG       ulDataLength;                   // byte size of argbIsdbCommand
    BYTE        argbIsdbCommand[1];
} BDA_ISDBCAS_REQUESTHEADER;

typedef struct BDA_ISDBCAS_RESPONSEDATA
{
    PBDARESULT  lResult;
    ULONG       ulRequestID;
    ULONG       ulIsdbStatus;
    ULONG       ulIsdbDataSize;
    BYTE        argbIsdbCommandData[1];
} BDA_ISDBCAS_RESPONSEDATA;

typedef struct BDA_ISDBCAS_EMG_REQ
{
    BYTE        bCLA;                           // 0x90
    BYTE        bINS;                           // 0x38
    BYTE        bP1;                            // 0x00
    BYTE        bP2;                            // 0x00
    BYTE        bLC;                            // Following bytes - 1(LE)
    BYTE        bCardId[6];                     // from EMM message packet
    BYTE        bProtocol;                      // from EMM message packet
    BYTE        bCABroadcasterGroupId;          // from EMM message packet
    BYTE        bMessageControl;                // from EMM message packet
    BYTE        bMessageCode[1];    // Last byte is reserved as 'LE'
} BDA_ISDBCAS_EMG_REQ;

#pragma pack(pop)

//=============================================================
// PBDA - MUX structures used in methods
//=============================================================
typedef enum MUX_PID_TYPE {
    PID_OTHER = -1,
    PID_ELEMENTARY_STREAM,            //  PES payloads
    PID_MPEG2_SECTION_PSI_SI,       //  ISO 13818_1 Sections PAT, PMT, CAT, Private. Service Information Sections e.g SDT, NIT, EIT, BAT
} MUX_PID_TYPE;

#pragma pack(push, 2)
typedef struct BDA_MUX_PIDLISTITEM
{
    USHORT          usPIDNumber;        //PID number of the stream
    USHORT          usProgramNumber;    //associated Service Id, if applicable
    MUX_PID_TYPE    ePIDType;           //PID Type of the stream if applicable
} BDA_MUX_PIDLISTITEM;
#pragma pack(pop)

//#endif

//=============================================================
// BDA - TS Selector structures used in methods
//=============================================================

//  |<-------------- bTSInfolength ---------------------->|
//  |                                                     |
//  |                     |                               |
//  | BDA_TS_SELECTORINFO | BDA_TS_SELECTORINFO_ISDBS_EXT |
//  |                     | (for ISDB-S extension)        |
//  |                     |                               |

#pragma pack(push, 1)
typedef struct BDA_TS_SELECTORINFO
{
    BYTE            bTSInfolength;          // buffer length including extension
    BYTE            bReserved[2];
    UUID            guidNetworkType;        // current type of tuning
    BYTE            bTSIDCount;             // number of usTSID
    USHORT          usTSID[1];
} BDA_TS_SELECTORINFO;

typedef struct BDA_TS_SELECTORINFO_ISDBS_EXT
{
    BYTE            bTMCC[48];
} BDA_TS_SELECTORINFO_ISDBS_EXT;
#pragma pack(pop)

//DVB-T2 related L1 signalling information returned in _GETTSINFORMATION

typedef struct BDA_DVBT2_L1_SIGNALLING_DATA
{
    BYTE  L1Pre_TYPE;
    BYTE  L1Pre_BWT_S1_S2;
    BYTE  L1Pre_REPETITION_GUARD_PAPR;
    BYTE  L1Pre_MOD_COD_FEC;
    BYTE  L1Pre_POSTSIZE_INFO_PILOT[5];
    BYTE  L1Pre_TX_ID_AVAIL;
    BYTE  L1Pre_CELL_ID[2];
    BYTE  L1Pre_NETWORK_ID[2];
    BYTE  L1Pre_T2SYSTEM_ID[2];
    BYTE  L1Pre_NUM_T2_FRAMES;
    BYTE  L1Pre_NUM_DATA_REGENFLAG_L1POSTEXT[2];
    BYTE  L1Pre_NUMRF_CURRENTRF_RESERVED[2];
    BYTE  L1Pre_CRC32[4];
    BYTE  L1PostData[1];
} BDA_DVBT2_L1_SIGNALLING_DATA;


//=============================================================
// PBDA - RATING structures used in methods
//=============================================================
typedef struct BDA_RATING_PINRESET
{
    BYTE    bPinLength;                 //Buffer size including a null termination
    BYTE    argbNewPin[1];  //Null terminated UTF8. Use empty string if disable pin
} BDA_RATING_PINRESET;

//=============================================================
//
//
//  BDA Tuning Model enumerations
//
//
//=============================================================

// system type for particular DVB Tuning Space instance
typedef enum DVBSystemType {
    DVB_Cable,
    DVB_Terrestrial,
    DVB_Satellite,
    ISDB_Terrestrial,
    ISDB_Satellite,
} DVBSystemType;

//------------------------------------------------------------
//
//  BDA Channel Tune Request

typedef enum  BDA_Channel {
    BDA_UNDEFINED_CHANNEL = -1,
} BDA_Channel;


//------------------------------------------------------------
//
//  BDA Component(substream)
//
//  Note: Persistent TS remember preferred component categories by their number.
//        Please update the rgs files at multimedia\dshow\vidctl\msvidctl\res
//        and multimedia\dshow\vidctl\manifests\Video-TVVideoControl.man accordingly
//        if the order/value changes.
//        Also make sure ehiProxy.asmmeta, ehiVidCtl.asmmeta and bdatunepia.asmmeta
//        are properly updated.
//
typedef enum ComponentCategory {
    CategoryNotSet = -1,
    CategoryOther = 0,
    CategoryVideo,
    CategoryAudio,
    CategoryText,
    CategorySubtitles,
    CategoryCaptions,
    CategorySuperimpose,
    CategoryData,
    CATEGORY_COUNT,
} ComponentCategory;

// Component Status
typedef enum ComponentStatus {
    StatusActive,
    StatusInactive,
    StatusUnavailable,
} ComponentStatus;


//------------------------------------------------------------
//
//  BDA MPEG2 Component Type
//
// from the MPEG2 specification
typedef enum MPEG2StreamType {
    BDA_UNITIALIZED_MPEG2STREAMTYPE = -1,
    Reserved1 = 0x00,
    ISO_IEC_11172_2_VIDEO = 0x01,
    ISO_IEC_13818_2_VIDEO = 0x02,
    ISO_IEC_11172_3_AUDIO = 0x03,
    ISO_IEC_13818_3_AUDIO = 0x04,
    ISO_IEC_13818_1_PRIVATE_SECTION = 0x05,
    ISO_IEC_13818_1_PES = 0x06,
    ISO_IEC_13522_MHEG = 0x07,
    ANNEX_A_DSM_CC = 0x08,
    ITU_T_REC_H_222_1 = 0x09,
    ISO_IEC_13818_6_TYPE_A = 0x0A,
    ISO_IEC_13818_6_TYPE_B = 0x0B,
    ISO_IEC_13818_6_TYPE_C = 0x0C,
    ISO_IEC_13818_6_TYPE_D = 0x0D,
    ISO_IEC_13818_1_AUXILIARY = 0x0E,
    ISO_IEC_13818_7_AUDIO = 0x0F,
    ISO_IEC_14496_2_VISUAL = 0x10,
    ISO_IEC_14496_3_AUDIO = 0x11,
    ISO_IEC_14496_1_IN_PES = 0x12,
    ISO_IEC_14496_1_IN_SECTION = 0x13,
    ISO_IEC_13818_6_DOWNLOAD = 0x14,
    METADATA_IN_PES = 0x15,
    METADATA_IN_SECTION = 0x16,
    METADATA_IN_DATA_CAROUSEL = 0x17,
    METADATA_IN_OBJECT_CAROUSEL = 0x18,
    METADATA_IN_DOWNLOAD_PROTOCOL = 0x19,
    IRPM_STREAMM = 0x1A,
    ITU_T_H264 = 0x1B,
    ISO_IEC_13818_1_RESERVED = 0x1C, // continues until 0x7F
    USER_PRIVATE = 0x10, // standard says 0x80, retaining for backwards compatibility
    HEVC_VIDEO_OR_TEMPORAL_VIDEO = 0x24,
    HEVC_TEMPORAL_VIDEO_SUBSET = 0x25,
    MPEG_H_AUDIO = 0x2D, // used for single-stream delivery or for the main stream in case of multi-stream delivery.
    MPEG_H_AUDIO_MS = 0x2E, // used for additional (auxiliary) stream in case of MPEG-H multi-stream delivery.
    ISO_IEC_USER_PRIVATE = 0x80,
    DOLBY_AC3_AUDIO = 0x81,
    DOLBY_DIGITAL_PLUS_AUDIO_ATSC = 0x87
} MPEG2StreamType;



//------------------------------------------------------------
//
//  mpeg-2 transport stride format block; associated with media
//   types MEDIATYPE_Stream/MEDIASUBTYPE_MPEG2_TRANSPORT_STRIDE;
//   *all* format blocks associated with above media type *must*
//   start with the MPEG2_TRANSPORT_STRIDE structure
//

//#ifndef MANAGED_ENUMS
typedef struct _MPEG2_TRANSPORT_STRIDE {
    DWORD   dwOffset;
    DWORD   dwPacketLength;
    DWORD   dwStride;
} MPEG2_TRANSPORT_STRIDE;
//#endif

//------------------------------------------------------------
//
//  BDA ATSC Component Type
//
//
// ATSC made AC3 Audio a descriptor instead of
// defining a user private stream type.

typedef enum ATSCComponentTypeFlags {
    // bit flags for various component type properties
    ATSCCT_AC3 = 0x00000001,
} ATSCComponentTypeFlags;


//------------------------------------------------------------
//
//  BDA Locators
//


typedef enum BinaryConvolutionCodeRate {
    BDA_BCC_RATE_NOT_SET = -1,
    BDA_BCC_RATE_NOT_DEFINED = 0,
    BDA_BCC_RATE_1_2 = 1,   // 1/2
    BDA_BCC_RATE_2_3,       // 2/3
    BDA_BCC_RATE_3_4,       // 3/4
    BDA_BCC_RATE_3_5,       // 3/5
    BDA_BCC_RATE_4_5,       // 4/5
    BDA_BCC_RATE_5_6,       // 5/6
    BDA_BCC_RATE_5_11,      // 5/11
    BDA_BCC_RATE_7_8,       // 7/8
    BDA_BCC_RATE_1_4,       // 1/4
    BDA_BCC_RATE_1_3,       // 1/3
    BDA_BCC_RATE_2_5,       // 2/5
    BDA_BCC_RATE_6_7,       // 6/7
    BDA_BCC_RATE_8_9,       // 8/9
    BDA_BCC_RATE_9_10,      // 9/10
    BDA_BCC_RATE_MAX,
} BinaryConvolutionCodeRate;

typedef enum FECMethod {
    BDA_FEC_METHOD_NOT_SET = -1,
    BDA_FEC_METHOD_NOT_DEFINED = 0,
    BDA_FEC_VITERBI = 1,    // FEC is a Viterbi Binary Convolution.
    BDA_FEC_RS_204_188,     // The FEC is Reed-Solomon 204/188 (outer FEC)
    BDA_FEC_LDPC,           // Low Density Parity Check error correction code
    BDA_FEC_BCH,            // Bose-Chaudhuri-Hocquenghem multiple error correction binary block code
    BDA_FEC_RS_147_130,     // The FEC is Reed-Solomon 147/130 (outer FEC) DirecTV-DSS
    BDA_FEC_MAX,
} FECMethod;

typedef enum ModulationType {
    BDA_MOD_NOT_SET = -1,
    BDA_MOD_NOT_DEFINED = 0,
    BDA_MOD_16QAM = 1,
    BDA_MOD_32QAM,
    BDA_MOD_64QAM,
    BDA_MOD_80QAM,
    BDA_MOD_96QAM,
    BDA_MOD_112QAM,
    BDA_MOD_128QAM,
    BDA_MOD_160QAM,
    BDA_MOD_192QAM,
    BDA_MOD_224QAM,
    BDA_MOD_256QAM,
    BDA_MOD_320QAM,
    BDA_MOD_384QAM,
    BDA_MOD_448QAM,
    BDA_MOD_512QAM,
    BDA_MOD_640QAM,
    BDA_MOD_768QAM,
    BDA_MOD_896QAM,
    BDA_MOD_1024QAM,
    BDA_MOD_QPSK,             // Quadrature Phase Shift Keying (including backwards compatible mode)
    BDA_MOD_BPSK,             // Binary Phase Shift Keying
    BDA_MOD_OQPSK,            // Offset QPSK
    BDA_MOD_8VSB,             // 8-Level Vestigial Sideband
    BDA_MOD_16VSB,            // 16-Level Vestigial Sideband
    BDA_MOD_ANALOG_AMPLITUDE, // std am
    BDA_MOD_ANALOG_FREQUENCY, // std fm
    BDA_MOD_8PSK,             // 8 Phase Shift Keying (including backwards compatible mode)
    BDA_MOD_RF, // analog TV (Video standards such as NTSC/PAL/SECAM specified in IAnalogLocator VideoStandard property)
    BDA_MOD_16APSK,           // DVB-S2 modulation 16-Level APSK
    BDA_MOD_32APSK,           // DVB-S2 modulation 32-Level APSK
    BDA_MOD_NBC_QPSK,         // Non-Backwards Compatible Quadrature Phase Shift Keying
    BDA_MOD_NBC_8PSK,         // Non-Backwards Compatible 8 Phase Shift Keying
    BDA_MOD_DIRECTV,          // DIRECTV DSS
    BDA_MOD_ISDB_T_TMCC,      // Automatic demodulation by Transmission and Multiplexing Configuration Control signal for ISDB-T
    BDA_MOD_ISDB_S_TMCC,      // Automatic demodulation by Transmission and Multiplexing Configuration Control signal for ISDB-S
    BDA_MOD_MAX,
} ModulationType;


typedef enum ScanModulationTypes
{
    BDA_SCAN_MOD_16QAM = 0x00000001,
    BDA_SCAN_MOD_32QAM = 0x00000002,
    BDA_SCAN_MOD_64QAM = 0x00000004,
    BDA_SCAN_MOD_80QAM = 0x00000008,
    BDA_SCAN_MOD_96QAM = 0x00000010,
    BDA_SCAN_MOD_112QAM = 0x00000020,
    BDA_SCAN_MOD_128QAM = 0x00000040,
    BDA_SCAN_MOD_160QAM = 0x00000080,
    BDA_SCAN_MOD_192QAM = 0x00000100,
    BDA_SCAN_MOD_224QAM = 0x00000200,
    BDA_SCAN_MOD_256QAM = 0x00000400,
    BDA_SCAN_MOD_320QAM = 0x00000800,
    BDA_SCAN_MOD_384QAM = 0x00001000,
    BDA_SCAN_MOD_448QAM = 0x00002000,
    BDA_SCAN_MOD_512QAM = 0x00004000,
    BDA_SCAN_MOD_640QAM = 0x00008000,
    BDA_SCAN_MOD_768QAM = 0x00010000,
    BDA_SCAN_MOD_896QAM = 0x00020000,
    BDA_SCAN_MOD_1024QAM = 0x00040000,
    BDA_SCAN_MOD_QPSK = 0x00080000,
    BDA_SCAN_MOD_BPSK = 0x00100000,
    BDA_SCAN_MOD_OQPSK = 0x00200000,
    BDA_SCAN_MOD_8VSB = 0x00400000,
    BDA_SCAN_MOD_16VSB = 0x00800000,
    BDA_SCAN_MOD_AM_RADIO = 0x01000000,
    BDA_SCAN_MOD_FM_RADIO = 0x02000000,
    BDA_SCAN_MOD_8PSK = 0x04000000,
    BDA_SCAN_MOD_RF = 0x08000000, // analog TV
    ScanModulationTypesMask_MCE_DigitalCable =11,// BDA_MOD_64QAM | BDA_MOD_256QAM,
    ScanModulationTypesMask_MCE_TerrestrialATSC = 24, //BDA_MOD_8VSB,
    //ScanModulationTypesMask_MCE_AnalogTv = BDA_MOD_RF,
    //ScanModulationTypesMask_MCE_All_TV = 0xffffffff,
    //ScanModulationTypesMask_DVBC = BDA_MOD_64QAM | BDA_SCAN_MOD_128QAM |
    //BDA_MOD_256QAM,
    BDA_SCAN_MOD_16APSK = 0x10000000,
    BDA_SCAN_MOD_32APSK = 0x20000000,
} ScanModulationTypes;

typedef enum SpectralInversion {
    BDA_SPECTRAL_INVERSION_NOT_SET = -1,
    BDA_SPECTRAL_INVERSION_NOT_DEFINED = 0,
    BDA_SPECTRAL_INVERSION_AUTOMATIC = 1,
    BDA_SPECTRAL_INVERSION_NORMAL,
    BDA_SPECTRAL_INVERSION_INVERTED,
    BDA_SPECTRAL_INVERSION_MAX
} SpectralInversion;

typedef enum Polarisation {
    BDA_POLARISATION_NOT_SET = -1,
    BDA_POLARISATION_NOT_DEFINED = 0,
    BDA_POLARISATION_LINEAR_H = 1, // Linear horizontal polarisation
    BDA_POLARISATION_LINEAR_V, // Linear vertical polarisation
    BDA_POLARISATION_CIRCULAR_L, // Circular left polarisation
    BDA_POLARISATION_CIRCULAR_R, // Circular right polarisation
    BDA_POLARISATION_MAX,
} Polarisation;

typedef enum LNB_Source {
    BDA_LNB_SOURCE_NOT_SET = -1,
    BDA_LNB_SOURCE_NOT_DEFINED = 0,
    BDA_LNB_SOURCE_A = 1, // 
    BDA_LNB_SOURCE_B = 2, // 
    BDA_LNB_SOURCE_C = 3, // 
    BDA_LNB_SOURCE_D = 4, // 
    BDA_LNB_SOURCE_MAX,
} LNB_Source;


typedef enum GuardInterval {
    BDA_GUARD_NOT_SET = -1,
    BDA_GUARD_NOT_DEFINED = 0,
    BDA_GUARD_1_32 = 1, // Guard interval is 1/32
    BDA_GUARD_1_16, // Guard interval is 1/16
    BDA_GUARD_1_8, // Guard interval is 1/8
    BDA_GUARD_1_4, // Guard interval is 1/4
    BDA_GUARD_1_128, // Guard interval is 1/128 (DVB-T2)
    BDA_GUARD_19_128, // Guard interval is 19/128 (DVB-T2)
    BDA_GUARD_19_256, // Guard interval is 19/256 (DVB-T2)
    BDA_GUARD_MAX,
} GuardInterval;

typedef enum HierarchyAlpha {
    BDA_HALPHA_NOT_SET = -1,
    BDA_HALPHA_NOT_DEFINED = 0,
    BDA_HALPHA_1 = 1, // Hierarchy alpha is 1.
    BDA_HALPHA_2, // Hierarchy alpha is 2.
    BDA_HALPHA_4, // Hierarchy alpha is 4.
    BDA_HALPHA_MAX,
} HierarchyAlpha;

typedef enum TransmissionMode {
    BDA_XMIT_MODE_NOT_SET = -1,
    BDA_XMIT_MODE_NOT_DEFINED = 0,
    BDA_XMIT_MODE_2K = 1, // Transmission uses 1705 carriers (use a 2K FFT)
    BDA_XMIT_MODE_8K,     // Transmission uses 6817 carriers (use an 8K FFT)
    BDA_XMIT_MODE_4K,
    BDA_XMIT_MODE_2K_INTERLEAVED,
    BDA_XMIT_MODE_4K_INTERLEAVED,
    BDA_XMIT_MODE_1K,    //DVB-T2 (use 1K FFT)
    BDA_XMIT_MODE_16K,   //DVB-T2 (use 16K FFT)
    BDA_XMIT_MODE_32K,   //DVB-T2 (use 32K FFT)
    BDA_XMIT_MODE_MAX,
} TransmissionMode;

typedef enum RollOff {
    BDA_ROLL_OFF_NOT_SET = -1,
    BDA_ROLL_OFF_NOT_DEFINED = 0,
    BDA_ROLL_OFF_20 = 1,         // .20 Roll Off (DVB-S2 Only)
    BDA_ROLL_OFF_25,             // .25 Roll Off (DVB-S2 Only)
    BDA_ROLL_OFF_35,             // .35 Roll Off (DVB-S2 Only)
    BDA_ROLL_OFF_MAX,
} RollOff;

typedef enum Pilot {
    BDA_PILOT_NOT_SET = -1,
    BDA_PILOT_NOT_DEFINED = 0,
    BDA_PILOT_OFF = 1,           // Pilot Off (DVB-S2 Only)
    BDA_PILOT_ON,                // Pilot On  (DVB-S2 Only)
    BDA_PILOT_MAX,
} Pilot;

typedef struct BDA_SIGNAL_TIMEOUTS
{
    ULONG      ulCarrierTimeoutMs;
    ULONG      ulScanningTimeoutMs;
    ULONG      ulTuningTimeoutMs;
} BDA_SIGNAL_TIMEOUTS;

//  Settings for Tuner Frequency
//
typedef enum BDA_Frequency {
    BDA_FREQUENCY_NOT_SET = -1,
    BDA_FREQUENCY_NOT_DEFINED = 0
} BDA_Frequency;

//  Settings for Tuner Range
//
//  Tuner range refers to the setting of LNB High/Low as well as the
//  selection of a satellite on a multiple satellite switch.
//
typedef enum BDA_Range {
    BDA_RANGE_NOT_SET = -1,
    BDA_RANGE_NOT_DEFINED = 0
} BDA_Range;

//  Settings for Tuner Channel Bandwidth
//
typedef enum BDA_Channel_Bandwidth {
    BDA_CHAN_BANDWITH_NOT_SET = -1,
    BDA_CHAN_BANDWITH_NOT_DEFINED = 0
} BDA_Channel_Bandwidth;

//  Settings for Tuner Frequency Multiplier
//
typedef enum BDA_Frequency_Multiplier {
    BDA_FREQUENCY_MULTIPLIER_NOT_SET = -1,
    BDA_FREQUENCY_MULTIPLIER_NOT_DEFINED = 0
} BDA_Frequency_Multiplier;

typedef enum BDA_Comp_Flags {
    // equiv comparison rule overrides, default behavior is type specific
    BDACOMP_NOT_DEFINED = 0x00000000,
    BDACOMP_EXCLUDE_TS_FROM_TR = 0x00000001,  // never put TS in TR equiv comparison
    BDACOMP_INCLUDE_LOCATOR_IN_TR = 0x00000002,  // always include loc in TR equiv comparison
    BDACOMP_INCLUDE_COMPONENTS_IN_TR = 0x00000004, // always include components in TR equiv comparison
} BDA_Comp_Flags;

typedef enum ApplicationTypeType
{
    SCTE28_ConditionalAccess = 0,
    SCTE28_POD_Host_Binding_Information,
    SCTE28_IPService,
    SCTE28_NetworkInterface_SCTE55_2,
    SCTE28_NetworkInterface_SCTE55_1,
    SCTE28_CopyProtection,
    SCTE28_Diagnostic,
    SCTE28_Undesignated,
    SCTE28_Reserved,
}ApplicationTypeType;


typedef enum BDA_CONDITIONALACCESS_REQUESTTYPE {
    CONDITIONALACCESS_ACCESS_UNSPECIFIED = 0,
    CONDITIONALACCESS_ACCESS_NOT_POSSIBLE,
    CONDITIONALACCESS_ACCESS_POSSIBLE,
    CONDITIONALACCESS_ACCESS_POSSIBLE_NO_STREAMING_DISRUPTION
} BDA_CONDITIONALACCESS_REQUESTTYPE;

typedef enum BDA_CONDITIONALACCESS_MMICLOSEREASON {
    CONDITIONALACCESS_UNSPECIFIED = 0,
    CONDITIONALACCESS_CLOSED_ITSELF,
    CONDITIONALACCESS_TUNER_REQUESTED_CLOSE,
    CONDITIONALACCESS_DIALOG_TIMEOUT,
    CONDITIONALACCESS_DIALOG_FOCUS_CHANGE,
    CONDITIONALACCESS_DIALOG_USER_DISMISSED,
    CONDITIONALACCESS_DIALOG_USER_NOT_AVAILABLE
} BDA_CONDITIONALACCESS_MMICLOSEREASON;

typedef enum BDA_CONDITIONALACCESS_SESSION_RESULT {
    CONDITIONALACCESS_SUCCESSFULL = 0,
    CONDITIONALACCESS_ENDED_NOCHANGE,
    CONDITIONALACCESS_ABORTED
} BDA_CONDITIONALACCESS_SESSION_RESULT;

typedef enum BDA_DISCOVERY_STATE {
    BDA_DISCOVERY_UNSPECIFIED = 0,
    BDA_DISCOVERY_REQUIRED,
    BDA_DISCOVERY_COMPLETE
} BDA_DISCOVERY_STATE;

// Digital Demodulator for DVBT2 Physical Layer Pipe
//#define        




//bdaiface_enums.h
typedef enum SmartCardStatusType
{
    CardInserted = 0,
    CardRemoved,
    CardError,
    CardDataChanged,
    CardFirmwareUpgrade
}SmartCardStatusType;

typedef enum SmartCardAssociationType
{
    NotAssociated = 0,
    Associated,
    AssociationUnknown
}SmartCardAssociationType;

typedef enum LocationCodeSchemeType
{
    SCTE_18 = 0
}LocationCodeSchemeType;

typedef struct EALocationCodeType {
    LocationCodeSchemeType LocationCodeScheme;
    BYTE state_code;
    BYTE county_subdivision;
    WORD county_code;
} EALocationCodeType;

typedef enum EntitlementType
{
    Entitled = 0,
    NotEntitled,
    TechnicalFailure
}EntitlementType;

typedef enum UICloseReasonType
{
    NotReady = 0,
    UserClosed,
    SystemClosed,
    DeviceClosed,
    ErrorClosed
}UICloseReasonType;

typedef struct SmartCardApplication {
    ApplicationTypeType ApplicationType;
    USHORT ApplicationVersion;
    BSTR pbstrApplicationName;
    BSTR pbstrApplicationURL;
} SmartCardApplication;

 

typedef enum BDA_DrmPairingError
{
    BDA_DrmPairing_Succeeded = 0,
    BDA_DrmPairing_HardwareFailure,
    BDA_DrmPairing_NeedRevocationData,
    BDA_DrmPairing_NeedIndiv,
    BDA_DrmPairing_Other,
    BDA_DrmPairing_DrmInitFailed,
    BDA_DrmPairing_DrmNotPaired,
    BDA_DrmPairing_DrmRePairSoon,
    BDA_DrmPairing_Aborted,
    BDA_DrmPairing_NeedSDKUpdate
}BDA_DrmPairingError;




//---------------------------------------------------------------------
//
//  IBDA_NetworkProvider interface
//
//  Implemented by a BDA Network Provider
//
//      Used by a BDA device filter to register itself with
//      a Network Provider and query information about the
//      the current tuning request.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(fd501041-8ebe-11ce-8183-00aa00577da2)
]
interface IBDA_NetworkProvider : stdole.IUnknown
{

    HRESULT
        PutSignalSource(
            [in] ULONG          ulSignalSource
        );


    HRESULT
        GetSignalSource(
            [in, out] ULONG* pulSignalSource
        );

    HRESULT
        GetNetworkType(
            [in, out] UUID* pguidNetworkType
        );

    HRESULT
        PutTuningSpace(
            [in] REFGUID        guidTuningSpace
        );

    HRESULT
        GetTuningSpace(
            [in, out] UUID* pguidTuingSpace
        );

    HRESULT
        RegisterDeviceFilter(
            [in]  IUnknown* pUnkFilterControl,
            [in, out] ULONG* ppvRegisitrationContext
        );

    HRESULT
        UnRegisterDeviceFilter(
            [in] ULONG          pvRegistrationContext
        );

}

//---------------------------------------------------------------------
//
//  IBDA_EthernetFilter interface
//
//  Implemented by a BDA Network Provider
//
//      Used by an Ethernet Network Data Sink filter (eg. IPSink) to
//      request that the Network Provider make its best effort to tune
//      to the stream(s) on which a list of Ethernet multicast addresses
//      may be transmitted.
//
//      Addresses in the address list are byte aligned in Network order.
//      UlcbAddresses will always be an integer multiple of the
//      size of an ethernet address.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(71985F43-1CA1-11d3-9CC8-00C04F7971E0)
]
interface IBDA_EthernetFilter : stdole.IUnknown
{
    HRESULT
        GetMulticastListSize(
            [in, out] ULONG * pulcbAddresses
        );

    HRESULT
        PutMulticastList(
            [in] ULONG                          ulcbAddresses,
            [in] BYTE*   pAddressList
        );

    HRESULT
        GetMulticastList(
            [in, out] ULONG* pulcbAddresses,
            [in, out] BYTE* pAddressList 
        );

    HRESULT
        PutMulticastMode(
            [in] ULONG      ulModeMask
        );

    HRESULT
        GetMulticastMode(
            [out] ULONG* pulModeMask
        );

}



//---------------------------------------------------------------------
//
//  IBDA_IPV4Filter interface
//
//  Implemented by a BDA Network Provider
//
//      Used by an IPv4 Network Data Sink filter to request
//      that the Network Provider make its best effort to tune
//      to the stream(s) on which a list of IPv4 multicast addresses
//      may be transmitted.
//
//      Addresses in the address list are byte aligned in Network order.
//      UlcbAddresses will always be an integer multiple of the
//      size of an IPv4 address.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(71985F44-1CA1-11d3-9CC8-00C04F7971E0)
]
interface IBDA_IPV4Filter : stdole.IUnknown
{

    HRESULT
        GetMulticastListSize(
            [in, out] ULONG * pulcbAddresses
        );

    HRESULT
        PutMulticastList(
            [in] ULONG                          ulcbAddresses,
            [in] BYTE* pAddressList
        );

    HRESULT
        GetMulticastList(
            [in, out] ULONG* pulcbAddresses,
            [out] BYTE* pAddressList
        );

    HRESULT
        PutMulticastMode(
            [in] ULONG  ulModeMask
        );

    HRESULT
        GetMulticastMode(
            [out] ULONG* pulModeMask
        );
}



//---------------------------------------------------------------------
//
//  IBDA_IPV6Filter interface
//
//  Implemented by a BDA Network Provider
//
//      Used by an IPv6 Network Data Sink filter to request
//      that the Network Provider make its best effort to tune
//      to the stream(s) on which a list of IPv6 multicast addresses
//      may be transmitted.
//
//      Addresses in the address list are byte aligned in Network order.
//      UlcbAddresses will always be an integer multiple of the
//      size of an IPv6 address.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(E1785A74-2A23-4fb3-9245-A8F88017EF33)
]
interface IBDA_IPV6Filter : stdole.IUnknown
{

    HRESULT
        GetMulticastListSize(
            [in, out] ULONG * pulcbAddresses
        );

    HRESULT
        PutMulticastList(
            [in] ULONG                          ulcbAddresses,
            [in] BYTE* pAddressList
        );

    HRESULT
        GetMulticastList(
            [in, out] ULONG* pulcbAddresses,
            [out] BYTE* pAddressList
        );

    HRESULT
        PutMulticastMode(
            [in] ULONG  ulModeMask
        );

    HRESULT
        GetMulticastMode(
            [out] ULONG* pulModeMask
        );
}



//---------------------------------------------------------------------
//
//  IBDA_DeviceControl interface
//
//  Implemented by a BDA Device Filter
//
//      Used by the Network Provider to commit a series of changes
//      on a BDA device filter.  The device filter validates and
//      accumulates all changes requested after StartChanges().  It
//      effects the accumulated list of changes when CommitChanges() is
//      called.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(FD0A5AF3-B41D-11d2-9C95-00C04F7971E0)
]
interface IBDA_DeviceControl : stdole.IUnknown
{
    HRESULT
        StartChanges(
            void
        );

    HRESULT
        CheckChanges(
            void
        );

    HRESULT
        CommitChanges(
            void
        );

    HRESULT
        GetChangeState(
            [in, out] ULONG* pState
        );

}



//---------------------------------------------------------------------
//
//  IBDA_PinControl interface
//
//  Implemented by a BDA Device Filter's Pin
//
//      Used by the Network Provider to determine the BDA PinID and
//      PinType on a BDA Filter's Pin
//
//---------------------------------------------------------------------
[
    odl,
        uuid(0DED49D5-A8B7-4d5d-97A1-12B0C195874D)
]
interface IBDA_PinControl : stdole.IUnknown
{
    HRESULT
        GetPinID(
            [in, out] ULONG * pulPinID
        );

    HRESULT
        GetPinType(
            [in, out] ULONG* pulPinType
        );

    HRESULT
        RegistrationContext(
            [in, out] ULONG* pulRegistrationCtx
        );
}



//---------------------------------------------------------------------
//
//  IBDA_SignalProperties interface
//
//  Implemented by a BDA Device Filter
//
//      BDA Signal Properties is used by a Network Provider to inform
//      a BDA Device Filter about the current tuning request.  The
//      Network Provider will call the Put functions when the BDA
//      device is first registered with the Network Provider and whenever
//      the current tuning request is modified.
//
//---------------------------------------------------------------------
[
    odl,
        uuid(D2F1644B-B409-11d2-BC69-00A0C9EE9E16)
]
interface IBDA_SignalProperties : stdole.IUnknown
{
    HRESULT
        PutNetworkType(
            [in] REFGUID        guidNetworkType
        );

    HRESULT
        GetNetworkType(
            [in, out] UUID* pguidNetworkType
        );

    HRESULT
        PutSignalSource(
            [in] ULONG          ulSignalSource
        );

    HRESULT
        GetSignalSource(
            [in, out] ULONG* pulSignalSource
        );

    HRESULT
        PutTuningSpace(
            [in] REFGUID        guidTuningSpace
        );

    HRESULT
        GetTuningSpace(
            [in, out] UUID* pguidTuingSpace
        );
}


//---------------------------------------------------------------------
//
//  IBDA_SignalStatistics interface
//
//  Implemented by a BDA Control Node
//
//      A BDA Control Node may return these properties to describe
//      the condition of a signal that is being received.
//
//
//
//
//---------------------------------------------------------------------
[
    odl,
        uuid(1347D106-CF3A-428a-A5CB-AC0D9A2A4338)
]
interface IBDA_SignalStatistics : stdole.IUnknown
{
    HRESULT
        put_SignalStrength(
            [in] LONG           lDbStrength
        );

    HRESULT
        get_SignalStrength(
            [in, out] LONG* plDbStrength
        );

    HRESULT
        put_SignalQuality(
            [in] LONG           lPercentQuality
        );

    HRESULT
        get_SignalQuality(
            [in, out] LONG* plPercentQuality
        );

    HRESULT
        put_SignalPresent(
            [in] BOOLEAN        fPresent
        );

    HRESULT
        get_SignalPresent(
            [in, out] BOOLEAN* pfPresent
        );

    HRESULT
        put_SignalLocked(
            [in] BOOLEAN        fLocked
        );

    HRESULT
        get_SignalLocked(
            [in, out] BOOLEAN* pfLocked
        );

    HRESULT
        put_SampleTime(
            [in] LONG           lmsSampleTime
        );

    HRESULT
        get_SampleTime(
            [in, out] LONG* plmsSampleTime
        );
}


//---------------------------------------------------------------------
//
//  IBDA_Topology interface
//
//  Implemented by a BDA Device Filter
//
//      Used by the Network Provider to query a BDA Device Filter's
//      possible topologies (template topology) and to configure
//      the device with an appropriate topology for the current
//      tuning request.  It is also used to get an IUnknown to
//      a control node which may be used to set specific tuning
//      information.
//
//---------------------------------------------------------------------
typedef struct REGPINMEDIUM
{
    UUID clsMedium;
    DWORD dw1;
    DWORD dw2;
} 	REGPINMEDIUM;
[
    odl,
        uuid(79B56888-7FEA-4690-B45D-38FD3C7849BE)
]
interface IBDA_Topology : stdole.IUnknown
{
    HRESULT
        GetNodeTypes(
            [in, out] ULONG * pulcNodeTypes,
            [in]  ULONG                                 ulcNodeTypesMax,
            [in, out] ULONG * rgulNodeTypes
        );

    HRESULT
        GetNodeDescriptors(
            [in, out] ULONG* ulcNodeDescriptors,
            [in]  ULONG         ulcNodeDescriptorsMax,
            [in, out] BDANODE_DESCRIPTOR* rgNodeDescriptors
        );

    HRESULT
        GetNodeInterfaces(
            [in]  ULONG                                     ulNodeType,
            [in, out] ULONG* pulcInterfaces,
            [in]  ULONG                                     ulcInterfacesMax,
            [in, out] UUID* rgguidInterfaces
        );

    HRESULT
        GetPinTypes(
            [in, out] ULONG* pulcPinTypes,
            [in]  ULONG                                 ulcPinTypesMax,
            [in, out] ULONG* rgulPinTypes
        );

    HRESULT
        GetTemplateConnections(
            [in, out] ULONG* pulcConnections,
            [in]  ULONG                             ulcConnectionsMax,
            [in, out] BDA_TEMPLATE_CONNECTION* rgConnections
        );

    HRESULT
        CreatePin(
            [in]  ULONG         ulPinType,
            [in, out] ULONG* pulPinId
        );

    HRESULT
        DeletePin(
            [in] ULONG      ulPinId
        );

    HRESULT
        SetMediaType(
            [in]  ULONG             ulPinId,
            [in]  AM_MEDIA_TYPE* pMediaType
        );

    HRESULT
        SetMedium(
            [in] ULONG          ulPinId,
            [in] REGPINMEDIUM* pMedium
        );

    HRESULT
        CreateTopology(
            [in] ULONG ulInputPinId,
            [in] ULONG ulOutputPinId
        );

    HRESULT
        GetControlNode(
            [in] ULONG              ulInputPinId,
            [in] ULONG              ulOutputPinId,
            [in] ULONG              ulNodeType,
            [in, out] IUnknown** ppControlNode
        );
}

//---------------------------------------------------------------------
// IBDA_VoidTransform interface
//---------------------------------------------------------------------
[
    odl,
        uuid(71985F46-1CA1-11d3-9CC8-00C04F7971E0)
]
interface IBDA_VoidTransform : stdole.IUnknown
{
    HRESULT
        Start(
            void
        );

    HRESULT
        Stop(
            void
        );

}

//---------------------------------------------------------------------
// IBDA_NullTransform interface
//---------------------------------------------------------------------
[
    odl,
        uuid(DDF15B0D-BD25-11d2-9CA0-00C04F7971E0)
]
interface IBDA_NullTransform : stdole.IUnknown
{
    HRESULT
        Start(
            void
        );

    HRESULT
        Stop(
            void
        );

}

//---------------------------------------------------------------------
// IBDA_FrequencyFilter interface
//---------------------------------------------------------------------
[
    odl,
        uuid(71985F47-1CA1-11d3-9CC8-00C04F7971E0)
]
interface IBDA_FrequencyFilter : stdole.IUnknown
{
    HRESULT
        put_Autotune(
            [in] ULONG                  ulTransponder
        );

    HRESULT
        get_Autotune(
            [in, out] ULONG* pulTransponder
        );

    HRESULT
        put_Frequency(
            [in] ULONG                  ulFrequency
        );

    HRESULT
        get_Frequency(
            [in, out] ULONG* pulFrequency
        );

    HRESULT
        put_Polarity(
            [in] Polarisation           Polarity
        );

    HRESULT
        get_Polarity(
            [in, out] Polarisation* pPolarity
        );

    HRESULT
        put_Range(
            [in] ULONG                  ulRange
        );

    HRESULT
        get_Range(
            [in, out] ULONG* pulRange
        );

    HRESULT
        put_Bandwidth(
            [in] ULONG                  ulBandwidth
        );

    HRESULT
        get_Bandwidth(
            [in, out] ULONG* pulBandwidth
        );

    HRESULT
        put_FrequencyMultiplier(
            [in] ULONG                  ulMultiplier
        );

    HRESULT
        get_FrequencyMultiplier(
            [in, out] ULONG* pulMultiplier
        );
}


//---------------------------------------------------------------------
// IBDA_LNBInfo interface
//---------------------------------------------------------------------
[
    odl,
        uuid(992CF102-49F9-4719-A664-C4F23E2408F4)
]
interface IBDA_LNBInfo : stdole.IUnknown
{
    HRESULT
        put_LocalOscilatorFrequencyLowBand(
            [in] ULONG          ulLOFLow
        );

    HRESULT
        get_LocalOscilatorFrequencyLowBand(
            [in, out] ULONG* pulLOFLow
        );

    HRESULT
        put_LocalOscilatorFrequencyHighBand(
            [in] ULONG          ulLOFHigh
        );

    HRESULT
        get_LocalOscilatorFrequencyHighBand(
            [in, out] ULONG* pulLOFHigh
        );

    HRESULT
        put_HighLowSwitchFrequency(
            [in] ULONG          ulSwitchFrequency
        );

    HRESULT
        get_HighLowSwitchFrequency(
            [in, out] ULONG* pulSwitchFrequency
        );
}

//---------------------------------------------------------------------
// IBDA_DiseqCommand interface
//---------------------------------------------------------------------
[
    odl,
        uuid(F84E2AB0-3C6B-45e3-A0FC-8669D4B81F11)
]
interface IBDA_DiseqCommand : stdole.IUnknown
{
    HRESULT
        put_EnableDiseqCommands(
            [in] BOOLEAN       bEnable
        );

    HRESULT
        put_DiseqLNBSource(
            [in] ULONG       ulLNBSource
        );

    HRESULT
        put_DiseqUseToneBurst(
            [in] BOOLEAN       bUseToneBurst
        );

    HRESULT
        put_DiseqRepeats(
            [in] ULONG       ulRepeats
        );

    HRESULT
        put_DiseqSendCommand(
            [in] ULONG       ulRequestId,
            [in] ULONG       ulcbCommandLen,
            [in] BYTE* pbCommand
        );

    HRESULT
        get_DiseqResponse(
            [in] ULONG              ulRequestId,
            [in, out] ULONG* pulcbResponseLen,
            [in, out] BYTE* pbResponse 
        );
}

//---------------------------------------------------------------------
// IBDA_AutoDemodulate interface
//---------------------------------------------------------------------
[
    odl,
        uuid(DDF15B12-BD25-11d2-9CA0-00C04F7971E0)
]
interface IBDA_AutoDemodulate : stdole.IUnknown
{
    HRESULT
        put_AutoDemodulate(
            void
        );
}

//---------------------------------------------------------------------
// IBDA_AutoDemodulateEx interface
//---------------------------------------------------------------------
[
    odl,
        uuid(34518D13-1182-48e6-B28F-B24987787326)
]
interface IBDA_AutoDemodulateEx : IBDA_AutoDemodulate
{
    HRESULT
        get_SupportedDeviceNodeTypes(
            [in] ULONG ulcDeviceNodeTypesMax,
            [out] ULONG* pulcDeviceNodeTypes,
            [in, out] UUID* pguidDeviceNodeTypes
        );

    HRESULT
        get_SupportedVideoFormats(
            [out] ULONG *pulAMTunerModeType,
            [out] ULONG *pulAnalogVideoStandard
        );

    HRESULT
        get_AuxInputCount(
            [in, out] ULONG* pulCompositeCount,
            [in, out] ULONG* pulSvideoCount
        );
}
// AMTunerModeType  
// AnalogVideoStandard  
//---------------------------------------------------------------------
// IBDA_DigitalDemodulator interface
//---------------------------------------------------------------------
[
    odl,
        uuid(EF30F379-985B-4d10-B640-A79D5E04E1E0)
]
interface IBDA_DigitalDemodulator : stdole.IUnknown
{
    HRESULT
        put_ModulationType(
            [in] ModulationType * pModulationType
        );

    HRESULT
        get_ModulationType(
            [in, out] ModulationType* pModulationType
        );

    HRESULT
        put_InnerFECMethod(
            [in] FECMethod* pFECMethod
        );

    HRESULT
        get_InnerFECMethod(
            [in, out] FECMethod* pFECMethod
        );

    HRESULT
        put_InnerFECRate(
            [in] BinaryConvolutionCodeRate* pFECRate
        );

    HRESULT
        get_InnerFECRate(
            [in, out] BinaryConvolutionCodeRate* pFECRate
        );

    HRESULT
        put_OuterFECMethod(
            [in] FECMethod* pFECMethod
        );

    HRESULT
        get_OuterFECMethod(
            [in, out] FECMethod* pFECMethod
        );

    HRESULT
        put_OuterFECRate(
            [in] BinaryConvolutionCodeRate* pFECRate
        );

    HRESULT
        get_OuterFECRate(
            [in, out] BinaryConvolutionCodeRate* pFECRate
        );

    HRESULT
        put_SymbolRate(
            [in] ULONG* pSymbolRate
        );

    HRESULT
        get_SymbolRate(
            [in, out] ULONG* pSymbolRate
        );

    HRESULT
        put_SpectralInversion(
            [in] SpectralInversion* pSpectralInversion
        );

    HRESULT
        get_SpectralInversion(
            [in, out] SpectralInversion* pSpectralInversion
        );
}

//---------------------------------------------------------------------
// IBDA_DigitalDemodulator2 interface
//---------------------------------------------------------------------

[
    odl,
        uuid(525ED3EE-5CF3-4e1e-9A06-5368A84F9A6E)
]
interface IBDA_DigitalDemodulator2 : IBDA_DigitalDemodulator
{
    HRESULT
        put_GuardInterval(
            [in] GuardInterval* pGuardInterval
        );

    HRESULT
        get_GuardInterval(
            [in, out] GuardInterval* pGuardInterval
        );

    HRESULT
        put_TransmissionMode(
            [in] TransmissionMode* pTransmissionMode
        );

    HRESULT
        get_TransmissionMode(
            [in, out] TransmissionMode* pTransmissionMode
        );

    HRESULT
        put_RollOff(
            [in] RollOff* pRollOff
        );

    HRESULT
        get_RollOff(
            [in, out] RollOff* pRollOff
        );

    HRESULT
        put_Pilot(
            [in] Pilot* pPilot
        );

    HRESULT
        get_Pilot(
            [in, out] Pilot* pPilot
        );
}

//---------------------------------------------------------------------
// IBDA_DigitalDemodulator3 interface
//---------------------------------------------------------------------

[
    odl,
        uuid(13F19604-7D32-4359-93A2-A05205D90AC9)
]
interface IBDA_DigitalDemodulator3 : IBDA_DigitalDemodulator2
{
    HRESULT
        put_SignalTimeouts(
            [in] BDA_SIGNAL_TIMEOUTS* pSignalTimeouts
        );

    HRESULT
        get_SignalTimeouts(
            [in, out] BDA_SIGNAL_TIMEOUTS* pSignalTimeouts
        );

    HRESULT
        put_PLPNumber(
            [in] ULONG* pPLPNumber
        );

    HRESULT
        get_PLPNumber(
            [in, out] ULONG* pPLPNumber
        );
}

typedef enum KSPROPERTY_IPSINK
{
    KSPROPERTY_IPSINK_MULTICASTLIST,
    KSPROPERTY_IPSINK_ADAPTER_DESCRIPTION,
    KSPROPERTY_IPSINK_ADAPTER_ADDRESS

} KSPROPERTY_IPSINK;



//---------------------------------------------------------------------
// ICCSubStreamFiltering interface
//
// Sets the filtering on the closed captioning (CC) pins
// of the VBICodec filter.
//---------------------------------------------------------------------
[
    odl,
        uuid(4B2BD7EA-8347-467b-8DBF-62F784929CC3),
        helpstring("ICCSubStreamFiltering Interface")
]
interface ICCSubStreamFiltering : stdole.IUnknown
{
    [propget, helpstring("property SubstreamTypes")] HRESULT SubstreamTypes([out, retval] long* pTypes);
    [propput, helpstring("property SubstreamTypes")] HRESULT SubstreamTypes([in] long Types);
};

//---------------------------------------------------------------------
// IBDA_IPSinkControl interface  (mutlimedia\filters.ks\ipsink)
// IBDA_IPSinkInfo    interface
//
//  IBDA_IPSinkControl is no longer being supported for Ring3 clients.
//  Use the BDA_IPSinkInfo interface instead.
//---------------------------------------------------------------------

[
    odl,
        uuid(3F4DC8E2-4050-11d3-8F4B-00C04F7971E2),
        helpstring("Not supported - Use IBDA_IPSinkInfo instead")
]
interface IBDA_IPSinkControl : stdole.IUnknown
{
    HRESULT GetMulticastList(
        [in, out]  long* pulcbSize,
        [in, out] LongPtr * pbBuffer
    );


    HRESULT GetAdapterIPAddress(
        [in, out] long* pulcbSize,
        [in, out] LongPtr* pbBuffer
    );

}

[
    odl,
        uuid(A750108F-492E-4d51-95F7-649B23FF7AD7)
]
interface IBDA_IPSinkInfo : stdole.IUnknown
{
    HRESULT get_MulticastList(                                             // returns  N 6-byte 802.3 IP addreses.
        [in, out] ULONG * pulcbAddresses,     // 6*N
        [out] LongPtr * ppbAddressList    // Allocated by caller, must deallocate in callee with CoTaskMemFree()
    );

    HRESULT get_AdapterIPAddress(
        [out] BSTR* pbstrBuffer
    );

    HRESULT get_AdapterDescription(
        [out] BSTR* pbstrBuffer
    );
}
//
//  mpeg-2 demultiplexer-specific interfaces follow
//

//---------------------------------------------------------------------
// IEnumPIDMap interface
//---------------------------------------------------------------------

//#ifdef REMOVE_THESE
//typedef enum {
//    MEDIA_TRANSPORT_PACKET,         //  complete TS packet e.g. pass-through mode
//    MEDIA_ELEMENTARY_STREAM,        //  PES payloads; audio/video only
//    MEDIA_MPEG2_PSI,                //  PAT, PMT, CAT, Private
//    MEDIA_TRANSPORT_PAYLOAD         //  gathered TS packet payloads (PES packets, etc...)
//} MEDIA_SAMPLE_CONTENT;
//
//typedef struct {
//    ULONG                   ulPID;
//    MEDIA_SAMPLE_CONTENT    MediaSampleContent;
//} PID_MAP;
//#endif // REMOVE_THESE

[
    odl,
        uuid (afb6c2a2-2c41-11d3-8a60-0000f81e0e4a)
]
interface IEnumPIDMap : stdole.IUnknown
{
    HRESULT
        Next(
            [in]                            ULONG       cRequest,
            [in, out]   PID_MAP * pPIDMap,
            [out]                           ULONG * pcReceived
        );

    HRESULT
        Skip(
            [in]    ULONG   cRecords
        );

    HRESULT
        Reset(
        );

    HRESULT
        Clone(
            [out]   IEnumPIDMap** ppIEnumPIDMap
        );
};

//---------------------------------------------------------------------
// IMPEG2PIDMap interface
//---------------------------------------------------------------------

[
    odl,
        uuid (afb6c2a1-2c41-11d3-8a60-0000f81e0e4a)
]
interface IMPEG2PIDMap : stdole.IUnknown
{
    HRESULT
        MapPID(
            [in]    ULONG                   culPID,
            [in]    ULONG * pulPID,
            [in]    MEDIA_SAMPLE_CONTENT    MediaSampleContent
        );

    HRESULT
        UnmapPID(
            [in]    ULONG   culPID,
            [in]    ULONG* pulPID
        );

    HRESULT
        EnumPIDMap(
            [out]   IEnumPIDMap** pIEnumPIDMap
        );
};

//---------------------------------------------------------------------
// IFrequencyMap interface
// Currently implemented on the TIF. The interface can be QIed on the NP
//---------------------------------------------------------------------,
        //hidden, restricted


[
    odl,
        uuid(06FB45C1-693C-4ea7-B79F-7A6A54D8DEF2),
        helpstring("IFrequencyMap Interface")
]
interface IFrequencyMap : stdole.IUnknown
{
    [helpstring("method get_FrequencyMapping")]
        HRESULT
        get_FrequencyMapping(
            [out] ULONG * ulCount,
            [out] LongPtr *ppulList
        );
    [helpstring("method put_FrequencyMapping")]
        HRESULT
        put_FrequencyMapping(
            [in] ULONG ulCount,
            [in] ULONG* pList 
        );
    [helpstring("method get_CountryCode")]
        HRESULT
        get_CountryCode(
            [out] ULONG* pulCountryCode
        );
    [helpstring("method put_CountryCode")]
        HRESULT
        put_CountryCode(
            [in] ULONG ulCountryCode
        );

    [helpstring("method get_DefaultFrequencyMapping")]
        HRESULT
        get_DefaultFrequencyMapping(
            [in] ULONG ulCountryCode,
            [out] ULONG* pulCount,
            [out] LongPtr* ppulList
        );


    [helpstring("method get_CountryCodeList")]
        HRESULT
        get_CountryCodeList(
            [out] ULONG* pulCount,
            [out] LongPtr* ppulList
        );
};

//---------------------------------------------------------------------
// IBDA_EasMessage interface
// Currently implemented on the TIF and registered as a service by TIF.
//---------------------------------------------------------------------

        //hidden, restricted
[
    odl,
        uuid(D806973D-3EBE-46de-8FBB-6358FE784208),
        helpstring("IBDA_EasMessage Interface") 
]
interface IBDA_EasMessage : stdole.IUnknown
{
    [helpstring("method get_EasMessage")]
        HRESULT
        get_EasMessage(
            [in] ULONG ulEventID,
            [in, out] IUnknown * *ppEASObject
        );
};

//cpp_quote("#define SID_BDA_EasMessage __uuidof(IBDA_EasMessage)")

//---------------------------------------------------------------------
// IBDA_TransportStreamInfo interface
// Currently implemented on the TIF and registered as a service by TIF.
//---------------------------------------------------------------------

        //hidden, restricted
[
    odl,
        uuid(8E882535-5F86-47AB-86CF-C281A72A0549),
        helpstring("IBDA_TransportStreamInfo Interface") 
]
interface IBDA_TransportStreamInfo : stdole.IUnknown
{
    [helpstring("method get_PatTableTickCount")]
        HRESULT
        get_PatTableTickCount(
            [out] ULONG * pPatTickCount
        );
};

//cpp_quote("#define SID_BDA_TransportStreamInfo __uuidof(IBDA_TransportStreamInfo)")

//---------------------------------------------------------------------
// IBDA_ConditionalAccess interface
//---------------------------------------------------------------------
[
    odl,
        uuid(CD51F1E0-7BE9-4123-8482-A2A796C0A6B0),
        helpstring("IBDA_ConditionalAccess Interface")
]
interface IBDA_ConditionalAccess : stdole.IUnknown
{
    [helpstring("method get_SmartCardStatus")]
        HRESULT
        get_SmartCardStatus(
            [out] SmartCardStatusType * pCardStatus,
            [out] SmartCardAssociationType * pCardAssociation,
            [out] BSTR * pbstrCardError,
            [out] VARIANT_BOOL * pfOOBLocked
        );

    [helpstring("method get_SmartCardInfo")]
        HRESULT
        get_SmartCardInfo(
            [out] BSTR* pbstrCardName,
            [out] BSTR* pbstrCardManufacturer,
            [out] VARIANT_BOOL* pfDaylightSavings,
            [out] BYTE* pbyRatingRegion,
            [out] LONG* plTimeZoneOffsetMinutes,
            [out] BSTR* pbstrLanguage,
            [out] EALocationCodeType* pEALocationCode
        );

    [helpstring("method get_SmartCardApplications")]
        HRESULT
        get_SmartCardApplications(
            [in, out] ULONG* pulcApplications,
            [in]  ULONG                                 ulcApplicationsMax,
            [in, out] SmartCardApplication* rgApplications 
        );

    [helpstring("method get_Entitlement")]
        HRESULT
        get_Entitlement(
            [in] USHORT usVirtualChannel,
            [out] EntitlementType* pEntitlement
        );

    [helpstring("method TuneByChannel")]
        HRESULT
        TuneByChannel(
            [in] USHORT usVirtualChannel
        );

    [helpstring("method SetProgram")]
        HRESULT
        SetProgram(
            [in] USHORT usProgramNumber
        );

    [helpstring("method AddProgram")]
        HRESULT
        AddProgram(
            [in] USHORT usProgramNumber
        );

    [helpstring("method RemoveProgram")]
        HRESULT
        RemoveProgram(
            [in] USHORT usProgramNumber
        );

    [helpstring("method GetModuleUI")]
        HRESULT
        GetModuleUI(
            [in] BYTE byDialogNumber,
            [out] BSTR* pbstrURL
        );

    [helpstring("method InformUIClosed")]
        HRESULT
        InformUIClosed(
            [in] BYTE byDialogNumber,
            [in] UICloseReasonType CloseReason
        );

}

////cpp_quote("#define SID_BDA_ConditionalAccess __uuidof(IBDA_ConditionalAccess)")

//---------------------------------------------------------------------
// IBDA_DiagnosticProperties interface
//---------------------------------------------------------------------

[
    odl,
        uuid(20e80cb5-c543-4c1b-8eb3-49e719eee7d4),
        helpstring("IBDA_DiagnosticProperties Interface"),
]
interface IBDA_DiagnosticProperties : IPropertyBag
{
};

//cpp_quote("#define SID_BDA_DiagnosticProperties __uuidof(IBDA_DiagnosticProperties)")

//---------------------------------------------------------------------
// IBDA_DRM interface
//---------------------------------------------------------------------

[
    odl,
        uuid(F98D88B0-1992-4cd6-A6D9-B9AFAB99330D),
        helpstring("IBDA_DRM Interface"),
]
interface IBDA_DRM : stdole.IUnknown
{
    // Get the DRM pairing status
    HRESULT GetDRMPairingStatus([out] DWORD * pdwStatus,    // Bit array indicating the status of DRM pairing
        [out] HRESULT * phError); // Error code returned
// Request a DRM pairing
HRESULT PerformDRMPairing([in] BOOL fSync);
};

//cpp_quote("#define SID_BDA_DRM __uuidof(IBDA_DRM)")

//---------------------------------------------------------------------
// IBDA_NameValueService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(7F0B3150-7B81-4ad4-98E3-7E9097094301),
        helpstring("IBDA_NameValueService Interface")
]
interface IBDA_NameValueService : stdole.IUnknown
{

    [helpstring("method GetNameByIndex")]
        HRESULT
        GetValueNameByIndex(
            [in] ULONG ulIndex,
            [out] BSTR * pbstrName
        );

    [helpstring("method GetValue")]
        HRESULT
        GetValue(
            [in]  BSTR bstrName,
            [in]  BSTR bstrLanguage,
            [out] BSTR* pbstrValue
        );

    [helpstring("method SetValue")]
        HRESULT
        SetValue(
            [in] ULONG ulDialogRequest,
            [in] BSTR bstrLanguage,
            [in] BSTR bstrName,
            [in] BSTR bstrValue,
            [in] ULONG ulReserved
        );

};


//cpp_quote("#define SID_BDA_NameValueService __uuidof(IBDA_NameValueService)")


//---------------------------------------------------------------------
// IBDA_ConditionalAccessEx interface
//---------------------------------------------------------------------
[
    odl,
        uuid(497C3418-23CB-44ba-BB62-769F506FCEA7),
        helpstring("IBDA_ConditionalAccessEx Interface")
]
interface IBDA_ConditionalAccessEx : stdole.IUnknown
{
    [helpstring("method CheckEntitlementToken")]
        HRESULT
        CheckEntitlementToken(
            [in] ULONG ulDialogRequest,
            [in] BSTR bstrLanguage,
            [in] BDA_CONDITIONALACCESS_REQUESTTYPE RequestType,
            [in] ULONG ulcbEntitlementTokenLen,
            [in] BYTE * pbEntitlementToken,
            [out] ULONG * pulDescrambleStatus
        );

    [helpstring("method SetCaptureToken")]
        HRESULT
        SetCaptureToken(
            [in] ULONG ulcbCaptureTokenLen,
            [in] BYTE* pbCaptureToken
        );

    [helpstring("method OpenBroadcastMmi")]
        HRESULT
        OpenBroadcastMmi(
            [in] ULONG ulDialogRequest,
            [in] BSTR bstrLanguage,
            [in] ULONG EventId
        );

    [helpstring("method CloseMmiDialog")]
        HRESULT
        CloseMmiDialog(
            [in] ULONG ulDialogRequest,
            [in] BSTR bstrLanguage,
            [in] ULONG ulDialogNumber,
            [in] BDA_CONDITIONALACCESS_MMICLOSEREASON ReasonCode,
            [out] ULONG* pulSessionResult
        );


    [helpstring("method CreateDialogRequestNumber")]
        HRESULT
        CreateDialogRequestNumber(
            [out] ULONG* pulDialogRequestNumber
        );
};

//cpp_quote("#define SID_BDA_ConditionalAccessEx __uuidof(IBDA_ConditionalAccessEx)")

//---------------------------------------------------------------------
// IBDA_ISDBConditionalAccess interface
//---------------------------------------------------------------------
[
    odl,
        uuid(5E68C627-16C2-4e6c-B1E2-D00170CDAA0F),
        helpstring("IBDA_ISDBConditionalAccess Interface")
]
interface IBDA_ISDBConditionalAccess : stdole.IUnknown
{
    [helpstring("method SetIsdbCasRequest")]
        HRESULT
        SetIsdbCasRequest(
            [in] ULONG ulRequestId,
            [in] ULONG ulcbRequestBufferLen,
            [in] BYTE * pbRequestBuffer
        );
};

//cpp_quote("#define SID_BDA_ISDBConditionalAccess __uuidof(IBDA_ISDBConditionalAccess)")

//---------------------------------------------------------------------
// IBDA_EventingService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(207C413F-00DC-4c61-BAD6-6FEE1FF07064),
        helpstring("IBDA_EventingService Interface")
]
interface IBDA_EventingService : stdole.IUnknown
{
    [helpstring("method CompleteEvent")]
        HRESULT
        CompleteEvent(
            [in] ULONG ulEventID,
            [in] ULONG ulEventResult
        );

}

//cpp_quote("#define SID_BDA_EventingService __uuidof(IBDA_EventingService)")

//---------------------------------------------------------------------
// IBDA_AUX interface
//---------------------------------------------------------------------
[
    odl,
        uuid(7DEf4C09-6E66-4567-A819-F0E17F4A81AB),
        helpstring("IBDA_AUX Interface")
]
interface IBDA_AUX : stdole.IUnknown
{

    [helpstring("method QueryCapabilities")]
        HRESULT
        QueryCapabilities(
            [out] DWORD * pdwNumAuxInputsBSTR
        );

    [helpstring("method EnumCapability")]
        HRESULT
        EnumCapability(
            [in] DWORD dwIndex,
            [out] DWORD* dwInputID,
            [out] UUID* pConnectorType,
            [out] DWORD* ConnTypeNum,
            [out] DWORD* NumVideoStds,
            [out] ULONGLONG* AnalogStds
        );
};

//cpp_quote("DEFINE_GUID(PBDA_AUX_CONNECTOR_TYPE_SVideo, 0xa0e905f4,0x24c9,0x4a54, 0xb7, 0x61, 0x21, 0x33, 0x55, 0xef, 0xc1, 0x3A);")
//cpp_quote("DEFINE_GUID(PBDA_AUX_CONNECTOR_TYPE_Composite, 0xf6298b4c,0xc725,0x4d42, 0x84, 0x9b, 0x41, 0x0b, 0xbb, 0x14, 0xea, 0x62);")

//cpp_quote("#define SID_BDA_AUX __uuidof(IBDA_AUX)")
//cpp_quote("DEFINE_GUID(CLSID_PBDA_AUX_DATA_TYPE, "0xfd456373, 0x3323, 0x4090, 0xad, 0xca, 0x8e, 0xd4, 0x5f, 0x55, 0xcf, 0x10);")

//---------------------------------------------------------------------
// IBDA_Encoder interface
//---------------------------------------------------------------------
[
    odl,
        uuid(3a8bad59-59fe-4559-a0ba-396cfaa98ae3),
        helpstring("IBDA_ Encoder Interface")
]
interface IBDA_Encoder : stdole.IUnknown
{

    [helpstring("method QueryCapabilities")]
        HRESULT
        QueryCapabilities(
            [out] DWORD * NumAudioFmts,
            [out] DWORD * NumVideoFmts
        );

    [helpstring("method EnumAudioCapability")]
        HRESULT
        EnumAudioCapability(
            [in] DWORD FmtIndex,
            [out] DWORD* MethodID,
            [out] DWORD* AlgorithmType,
            [out] DWORD* SamplingRate,
            [out] DWORD* BitDepth,
            [out] DWORD* NumChannels
        );

    [helpstring("method EnumVideoCapability")]
        HRESULT
        EnumVideoCapability(
            [in] DWORD FmtIndex,
            [out] DWORD* MethodID,
            [out] DWORD* AlgorithmType,
            [out] DWORD* VerticalSize,
            [out] DWORD* HorizontalSize,
            [out] DWORD* AspectRatio,
            [out] DWORD* FrameRateCode,
            [out] DWORD* ProgressiveSequence
        );

    [helpstring("method SetParameters")]
        HRESULT
        SetParameters(
            [in] DWORD AudioBitrateMode,
            [in] DWORD AudioBitrate,
            [in] DWORD AudioMethodID,
            [in] DWORD AudioProgram,
            [in] DWORD VideoBitrateMode,
            [in] DWORD VideoBitrate,
            [in] DWORD VideoMethodID
        );

    [helpstring("method GetState")]
        HRESULT
        GetState(
            [out] DWORD* AudioBitrateMax,
            [out] DWORD* AudioBitrateMin,
            [out] DWORD* AudioBitrateMode,
            [out] DWORD* AudioBitrateStepping,
            [out] DWORD* AudioBitrate,
            [out] DWORD* AudioMethodID,
            [out] DWORD* AvailableAudioPrograms,
            [out] DWORD* AudioProgram,
            [out] DWORD* VideoBitrateMax,
            [out] DWORD* VideoBitrateMin,
            [out] DWORD* VideoBitrateMode,
            [out] DWORD* VideoBitrate,
            [out] DWORD* VideoBitrateStepping,
            [out] DWORD* VideoMethodID,
            [out] DWORD* SignalSourceID,
            [out] ULONGLONG* SignalFormat,
            [out] BOOL* SignalLock,
            [out] LONG* SignalLevel,
            [out] DWORD* SignalToNoiseRatio);

};

 
typedef enum PBDAEncoderDataTypes
{
    PBDA_Encoder_Audio_AlgorithmType_MPEG1LayerII = 0x00000000,
    PBDA_Encoder_Audio_AlgorithmType_AC3 = 0x00000001,
    PBDA_Encoder_Video_MPEG2PartII = 0x00000000,
    PBDA_Encoder_Video_MPEG4Part10 = 0x00000001,
    PBDA_Encoder_Video_AVC = 0x00000001,
    PBDA_Encoder_Video_H264 = 0x00000001,
} PBDAEncoderDataTypes;
typedef enum PBDAEncoderBitrateModes
{
    PBDA_Encoder_BitrateMode_Constant = 0x00000001,
    PBDA_Encoder_BitrateMode_Variable = 0x00000002,
    PBDA_Encoder_BitrateMode_Average = 0x00000003
} PBDAEncoderBitrateModes;
//---------------------------------------------------------------------
// IBDA_FDC interface
//---------------------------------------------------------------------
[
    odl,
        uuid(138adc7e-58ae-437f-b0b4-c9fe19d5b4ac),
        helpstring("IBDA_ FDC Interface")
]
interface IBDA_FDC : stdole.IUnknown
{

    [helpstring("method GetStatus")]
        HRESULT
        GetStatus(
            [out] DWORD * CurrentBitrate,
            [out] BOOL * CarrierLock,
            [out] DWORD * CurrentFrequency,
            [out] BOOL * CurrentSpectrumInversion,
            [out] BSTR * CurrentPIDList,
            [out] BSTR * CurrentTIDList,
            [out] BOOL * Overflow
        );

    [helpstring("method RequestTables")]
        HRESULT
        RequestTables(
            [in] BSTR TableIDs
        );

    [helpstring("method AddPid")]
        HRESULT
        AddPid(
            [in] BSTR PidsToAdd,
            [out] DWORD* RemainingFilterEntries
        );

    [helpstring("method RemovePid")]
        HRESULT
        RemovePid(
            [in] BSTR PidsToRemove
        );

    [helpstring("method AddTid")]
        HRESULT
        AddTid(
            [in] BSTR TidsToAdd,
            [out] BSTR* CurrentTidList
        );

    [helpstring("method RemoveTid")]
        HRESULT
        RemoveTid(
            [in] BSTR TidsToRemove
        );

    [helpstring("method GetTableSection")]
        HRESULT
        GetTableSection(
            [out] DWORD* Pid,
            [in] DWORD MaxBufferSize,
            [out] DWORD* ActualSize,
            [out] BYTE* SecBuffer
        );
 
};



//---------------------------------------------------------------------
// IBDA_GuideDataDeliveryService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(C0AFCB73-23E7-4bc6-BAFA-FDC167B4719F),
        helpstring("IBDA_ GuideDataDeliveryService Interface")
]
interface IBDA_GuideDataDeliveryService : stdole.IUnknown
{
    [helpstring("method GetGuideDataType")]
        HRESULT
        GetGuideDataType(
            [out] UUID * pguidDataType
        );

    [helpstring("method GetGuideData")]
        HRESULT
        GetGuideData(
            [in, out]  ULONG* pulcbBufferLen,
            [out] BYTE* pbBuffer,
            [out] ULONG* pulGuideDataPercentageProgress
        );

    [helpstring("method RequestGuideDataUpdate")]
        HRESULT
        RequestGuideDataUpdate();

    [helpstring("method GetTuneXmlFromServiceIdx ")]
        HRESULT
        GetTuneXmlFromServiceIdx(
            [in]  ULONG64 ul64ServiceIdx,
            [out] BSTR* pbstrTuneXml
        );

    [helpstring("method GetServices")]
        HRESULT
        GetServices(
            [in, out]  ULONG* pulcbBufferLen,
            [out] BYTE* pbBuffer
        );

    [helpstring("method GetServiceInfoFromTuneXml")]
        HRESULT
        GetServiceInfoFromTuneXml(
            [in]  BSTR bstrTuneXml,
            [out] BSTR* pbstrServiceDescription
        );
}
 
//---------------------------------------------------------------------
// IBDA_DRMService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(BFF6B5BB-B0AE-484c-9DCA-73528FB0B46E),
        helpstring("IBDA_DRMService Interface")
]
interface IBDA_DRMService : stdole.IUnknown
{
    [helpstring("method SetDRM")]
        HRESULT SetDRM(
            [in] UUID * puuidNewDrm
        );

    [helpstring("method GetDRMStatus")]
        HRESULT GetDRMStatus(
            [out] BSTR* pbstrDrmUuidList,
            [out] UUID* DrmUuid
        );

}
 
//---------------------------------------------------------------------
// IBDA_WMDRMSession interface
//---------------------------------------------------------------------
[
    odl,
        uuid(4BE6FA3D-07CD-4139-8B80-8C18BA3AEC88),
        helpstring("IBDA_WMDRMSession Interface")
]
interface IBDA_WMDRMSession : stdole.IUnknown
{

    [helpstring("method GetStatus")]
        HRESULT GetStatus(
            [out] ULONG * MaxCaptureToken,
            [out] ULONG * MaxStreamingPid,
            [out] ULONG * MaxLicense,
            [out] ULONG * MinSecurityLevel,
            [out] ULONG * RevInfoSequenceNumber,
            [out] ULONGLONG * RevInfoIssuedTime,
            [out] ULONG * RevInfoTTL,
            [out] ULONG * RevListVersion,
            [out] ULONG * ulState
        );

    [helpstring("method SetRevInfo ")]
        HRESULT SetRevInfo(
            [in] ULONG ulRevInfoLen,
            [in] BYTE* pbRevInfo
        );

    [helpstring("method SetCrl ")]
        HRESULT SetCrl(
            [in] ULONG ulCrlLen,
            [in] BYTE* pbCrlLen
        );

    [helpstring("method TransactMessage")]
        HRESULT TransactMessage(
            [in] ULONG ulcbRequest,
            [in] BYTE* pbRequest,
            [in, out] ULONG* pulcbResponse,
            [in, out] BYTE* pbResponse
        );

    [helpstring("method GetLicense")]
        HRESULT GetLicense(
            [in] UUID* uuidKey,
            [in, out] ULONG* pulPackageLen,
            [in, out] BYTE* pbPackage
        );

    [helpstring("method ReissueLicense")]
        HRESULT ReissueLicense(
            [in] UUID* uuidKey
        );

    [helpstring("method RenewLicense")]
        HRESULT RenewLicense(
            [in] ULONG ulInXmrLicenseLen,
            [in] BYTE* pbInXmrLicense,
            [in] ULONG ulEntitlementTokenLen,
            [in] BYTE* pbEntitlementToken,
            [out] ULONG* pulDescrambleStatus,
            [in, out] ULONG* pulOutXmrLicenseLen,
            [in, out] BYTE* pbOutXmrLicense
        );

    [helpstring("method GetKeyInfo")]
        HRESULT GetKeyInfo(
            [in, out] ULONG* pulKeyInfoLen,
            [in, out] BYTE* pbKeyInfo
        );

}
 
//---------------------------------------------------------------------
// IBDA_WMDRMTuner interface
//---------------------------------------------------------------------
[
    odl,
        uuid(86D979CF-A8A7-4f94-B5FB-14C0ACA68FE6),
        helpstring("IBDA_WMDRMTuner Interface")
]
interface IBDA_WMDRMTuner : stdole.IUnknown
{
    [helpstring("method PurchaseEntitlement ")]
        HRESULT PurchaseEntitlement(
            [in] ULONG ulDialogRequest,
            [in] BSTR bstrLanguage,
            [in] ULONG ulPurchaseTokenLen,
            [in] BYTE * pbPurchaseToken,
            [out] ULONG * pulDescrambleStatus,
            [in, out] ULONG * pulCaptureTokenLen,
            [in, out] BYTE * pbCaptureToken
        );

    [helpstring("method CancelCaptureToken ")]
        HRESULT CancelCaptureToken(
            [in] ULONG ulCaptureTokenLen,
            [in] BYTE* pbCaptureToken
        );

    [helpstring("method SetPidProtection")]
        HRESULT SetPidProtection(
            [in] ULONG ulPid,
            [in] UUID* uuidKey
        );

    [helpstring("method GetPidProtection ")]
        HRESULT GetPidProtection(
            [in]  ULONG pulPid,
            [out] UUID* uuidKey
        );

    [helpstring("method SetSyncValue ")]
        HRESULT SetSyncValue(
            [in] ULONG ulSyncValue
        );

    [helpstring("method GetStartCodeProfile ")]
        HRESULT GetStartCodeProfile(
            [in, out] ULONG* pulStartCodeProfileLen,
            [in, out] BYTE* pbStartCodeProfile
        );

}
 
//---------------------------------------------------------------------
// IBDA_DRIDRMService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(1F9BC2A5-44A3-4c52-AAB1-0BBCE5A1381D),
        helpstring("IBDA_DRIDRMService Interface")
]
interface IBDA_DRIDRMService : stdole.IUnknown
{
    [helpstring("method SetDRM")]
        HRESULT SetDRM(
            [in] BSTR bstrNewDrm
        );

    [helpstring("method GetDRMStatus")]
        HRESULT GetDRMStatus(
            [out] BSTR* pbstrDrmUuidList,
            [out] UUID* DrmUuid
        );

    [helpstring("method GetPairingStatus")]
        HRESULT GetPairingStatus(
            [in, out] BDA_DrmPairingError* penumPairingStatus
        );
}
 

//---------------------------------------------------------------------
// IBDA_DRIWMDRMSession interface
//---------------------------------------------------------------------
[
    odl,
        uuid(05C690F8-56DB-4bb2-B053-79C12098BB26),
        helpstring("IBDA_DRIWMDRMSession Interface")
]
interface IBDA_DRIWMDRMSession : stdole.IUnknown
{
    [helpstring("method AcknowledgeLicense")]
        HRESULT AcknowledgeLicense(
            [in] HRESULT hrLicenseAck
        );

    [helpstring("method ProcessLicenseChallenge")]
        HRESULT ProcessLicenseChallenge(
            [in] DWORD dwcbLicenseMessage,
            [in] BYTE* pbLicenseMessage,
            [in, out] DWORD* pdwcbLicenseResponse,
            [in, out] LongPtr* ppbLicenseResponse
        );

    [helpstring("method ProcessRegistrationChallenge")]
        HRESULT ProcessRegistrationChallenge(
            [in] DWORD dwcbRegistrationMessage,
            [in] BYTE* pbRegistrationMessage,
            [in, out] DWORD* pdwcbRegistrationResponse,
            [in, out] LongPtr* ppbRegistrationResponse
        );

    [helpstring("method SetRevInfo ")]
        HRESULT SetRevInfo(
            [in] DWORD dwRevInfoLen,
            [in] BYTE* pbRevInfo,
            [in, out] DWORD* pdwResponse
        );

    [helpstring("method SetCrl ")]
        HRESULT SetCrl(
            [in] DWORD dwCrlLen,
            [in] BYTE* pbCrlLen,
            [in, out] DWORD* pdwResponse
        );

    [helpstring("method GetHMSAssociationData ")]
        HRESULT GetHMSAssociationData();

    [helpstring("method GetLastCardeaError ")]
        HRESULT GetLastCardeaError(
            [in, out] DWORD* pdwError
        );
}
 

//---------------------------------------------------------------------
// IBDA_MUX interface
//---------------------------------------------------------------------
[
    odl,
        uuid(942AAFEC-4C05-4c74-B8EB-8706C2A4943F),
        helpstring("IBDA_MUX Interface")
]
interface IBDA_MUX : stdole.IUnknown
{
    [helpstring("method SetPidList")]
        HRESULT SetPidList(
            [in] ULONG ulPidListCount,
            [in] BDA_MUX_PIDLISTITEM * pbPidListBuffer
        );

    [helpstring("method GetPidList")]
        HRESULT GetPidList(
            [in, out] ULONG* pulPidListCount,
            [in, out] BDA_MUX_PIDLISTITEM* pbPidListBuffer
        );
}
 
//---------------------------------------------------------------------
// IBDA_TransportStreamSelector interface
//---------------------------------------------------------------------
[
    odl,
        uuid(1DCFAFE9-B45E-41b3-BB2A-561EB129AE98),
        helpstring("IBDA_TransportStreamSelector Interface")
]
interface IBDA_TransportStreamSelector : stdole.IUnknown
{
    [helpstring("method SetTSID")]
        HRESULT
        SetTSID(
            [in] USHORT usTSID
        );

    [helpstring("method GetTSInformation")]
        HRESULT
        GetTSInformation(
            [in, out] ULONG* pulTSInformationBufferLen,
            [out] BYTE* pbTSInformationBuffer // BDA_TS_SELECTORINFO
        );
}
 

//---------------------------------------------------------------------
// IBDA_UserActivityService interface
//---------------------------------------------------------------------
[
    odl,
        uuid(53B14189-E478-4b7a-A1FF-506DB4B99DFE),
        helpstring("IBDA_UserActivityService Interface")
]
interface IBDA_UserActivityService : stdole.IUnknown
{
    [helpstring("method SetCurrentTunerUseReason")]
        HRESULT SetCurrentTunerUseReason(
            [in] DWORD dwUseReason
        );

    [helpstring("method GetUserActivityInterval")]
        HRESULT GetUserActivityInterval(
            [out] DWORD* pdwActivityInterval
        );

    [helpstring("method UserActivityDetected")]
        HRESULT UserActivityDetected();
}
 
///////////////////////////////////////////////////////////////////////////////////////
// Eventing System interfaces
// See also tuner.idl
///////////////////////////////////////////////////////////////////////////////////////

//
// Generic and specific events that could return
// in OnESEventReceived
//
[
    odl,
        uuid(1F0E5357-AF43-44e6-8547-654C645145D2),
        helpstring("IESEvent Interface")
]
interface IESEvent : stdole.IUnknown
{
    // Get current information of the event
    HRESULT GetEventId([out, retval] DWORD * pdwEventId);
    HRESULT GetEventType([out, retval] UUID* pguidEventType);

    // Set the completion status of the event if the callee processes the event.
    HRESULT SetCompletionStatus([in]DWORD dwResult);

    // Get the data in byte array.
    // use NULL pbData to determine data length
    // Get the data in byte array.
    HRESULT GetData([out, retval] SAFEARRAY(BYTE)* pbData);

    // Get the data in unicode string format.
    HRESULT GetStringData([out, retval] BSTR* pbstrData);
};

[
    odl,
        uuid(ABD414BF-CFE5-4e5e-AF5B-4B4E49C5BFEB),
        helpstring("Eventing out-going client interface")
]
interface IESEvents : stdole.IUnknown
{
    HRESULT OnESEventReceived([in] long guidEventType1,[in] long guidEventType2,[in] long guidEventType3,[in] long guidEventType4,[in] IESEvent * pESEvent);
};

[
    odl, 
        uuid(3B21263F-26E8-489d-AAC4-924F7EFD9511),
        helpstring("Broadcast Event Service Firing/Reflecting Interface")
]
interface IBroadcastEvent : stdole.IUnknown
{
    HRESULT Fire([in] long EventID1,[in] long EventID2,[in] long EventID3,[in] long EventID4);
};

[
    odl, 
        uuid(3d9e3887-1929-423f-8021-43682de95448),
        helpstring("Enhanced Broadcast Event Service Firing/Reflecting Interface")
]
interface IBroadcastEventEx : IBroadcastEvent
{
    HRESULT FireEx([in] long EventID1, [in] long EventID2, [in] long EventID3, [in] long EventID4, [in] ULONG Param1, [in] ULONG Param2, [in] ULONG Param3, [in] ULONG Param4);
};






//      Mpeg2Bits.h
typedef struct
{
    //WORD Reserved : 3;
    //WORD ProgramId : 13;
    WORD Bits;
} PID_BITS;

typedef struct
{
    WORD Bits;
} MPEG_HEADER_BITS;

typedef struct
{
    BYTE Bits;
} MPEG_HEADER_VERSION_BITS;




//mpeg2structs.h/idl

#pragma pack(push)
#pragma pack(1)

//
// Basic Type Aliases
//

typedef WORD PID;  // program id
typedef BYTE TID;  // table id
typedef WORD TEID; // table extension id
typedef UINT ClientKey;



//
// MPEG-2 Current/Next bit field
//

typedef enum
{
    MPEG_SECTION_IS_NEXT = 0,
    MPEG_SECTION_IS_CURRENT = 1
} MPEG_CURRENT_NEXT_BIT;


//
// MPEG-2 TID Extension structure
//

typedef struct
{
    WORD   wTidExt;
    WORD   wCount;
} TID_EXTENSION;



//
// MPEG-2 packet "small" header structure
//

typedef struct
{
    TID     TableId;
    //union
    //{
    //    MPEG_HEADER_BITS_MIDL S;
    //    WORD                  W;
    //}       Header;
    WORD Header;
    BYTE    SectionData[1];     // Array size is Header.S.SectionLength
} SECTION;



//
// MPEG-2 packet "long" header structure
//

typedef struct
{
    TID     TableId;
    //union
    //{
    //    MPEG_HEADER_BITS_MIDL S;
    //    WORD                  W;
    //}       Header;
    WORD Header;
    TEID    TableIdExtension;
    //union
    //{
    //    MPEG_HEADER_VERSION_BITS_MIDL S;
    //    BYTE                          B;
    //}       Version;
    BYTE Version;
    BYTE    SectionNumber;
    BYTE    LastSectionNumber;
    BYTE    RemainingData[1];   // Array size is Header.S.SectionLength - 5
} LONG_SECTION;



//
// DSM-CC packet header structure
//

typedef struct
{
    TID     TableId;
    //union
    //{
    //    MPEG_HEADER_BITS_MIDL S;
    //    WORD                  W;
    //}       Header;
    WORD Header;
    TEID    TableIdExtension;
    //union
    //{
    //    MPEG_HEADER_VERSION_BITS_MIDL S;
    //    BYTE                          B;
    //}       Version;
    BYTE Version;
    BYTE    SectionNumber;
    BYTE    LastSectionNumber;
    BYTE    ProtocolDiscriminator;
    BYTE    DsmccType;
    WORD    MessageId;
    DWORD   TransactionId;
    BYTE    Reserved;
    BYTE    AdaptationLength;
    WORD    MessageLength;
    BYTE    RemainingData[1];
} DSMCC_SECTION;



//
// MPEG-2 request/response packets structures
//

typedef struct
{
    DWORD    dwLength;
    //PSECTION pSection;
    LongPtr pSection;
} MPEG_RQST_PACKET;

typedef struct
{
    WORD              wPacketCount;
    //[size_is(wPacketCount)] PMPEG_RQST_PACKET PacketList[];
    LongPtr PacketList;
} MPEG_PACKET_LIST;



//
// DSM-CC request filter options
//

typedef struct
{
    BOOL  fSpecifyProtocol;       // If true, Protocol should be set to desired value
    BYTE  Protocol;
    BOOL  fSpecifyType;           // If true, Type should be set to desired value
    BYTE  Type;
    BOOL  fSpecifyMessageId;      // If true, MessageId should be set to desired value
    WORD  MessageId;
    BOOL  fSpecifyTransactionId;  // If true, TransactionId (or DownloadId for DDB msgs) should be set to desired value
    BOOL  fUseTrxIdMessageIdMask; // If false, TransactionId is filtered as is.
    // If true, TransactionId is masked to look
    // for any version of message with associated
    // message identifier. See DVB - Data
    // Broadcasting Guidlines 4.6.5. (Assignment
    // and use of transactionId values).
    DWORD TransactionId;
    BOOL  fSpecifyModuleVersion;  // If true, ModuleVersion should be set to the desired value
    BYTE  ModuleVersion;
    BOOL  fSpecifyBlockNumber;    // If true, BlockNumber should be set to desired value
    WORD  BlockNumber;
    BOOL  fGetModuleCall;         // If true, NumberOfBlocksInModule should be set
    WORD  NumberOfBlocksInModule;
} DSMCC_FILTER_OPTIONS;
// 45 BYTES



//
// ATSC request filter options
//

typedef struct
{
    BOOL  fSpecifyEtmId;          // If true, EtmId should be set to desired value
    DWORD EtmId;
} ATSC_FILTER_OPTIONS;
// 8 BYTES



//
// DVB/ISDB EIT request filter options
//

typedef struct
{
    BOOL fSpecifySegment;        // If true, bSegment should be set to desired value
    BYTE bSegment;
} DVB_EIT_FILTER_OPTIONS;
// 5 BYTES



//
// MPEG-2 request filter structure
//

typedef struct
{
    BYTE  bVersionNumber;           // Must be set to 1 or more to match filter definition
    WORD  wFilterSize;              // Size of total filter structure. Version 1 filter is 73 bytes.
    BOOL  fUseRawFilteringBits;     // If true, Filter and Mask fields should be set to desired value, all other
    // fields with be ignored.
    BYTE  Filter[16];               // Bits with values to compare against for a match.
    BYTE  Mask[16];                 // Bits set to 0 are bits that are compared to those in the filter, those
    // bits set to 1 are ignored.
    BOOL  fSpecifyTableIdExtension; // If true, TableIdExtension should be set to desired value (false = don't care)
    WORD  TableIdExtension;
    BOOL  fSpecifyVersion;          // If true, Version should be set to desired value (false = don't care)
    BYTE  Version;
    BOOL  fSpecifySectionNumber;    // If true, SectionNumber should be set to desired value (false = don't care)
    BYTE  SectionNumber;
    BOOL  fSpecifyCurrentNext;      // If true, fNext should be set to desired value (false = don't care)
    BOOL  fNext;                    // If true, next table is queried. Else, current
    BOOL  fSpecifyDsmccOptions;     // If true, Dsmcc should be set with desired filter options
    DSMCC_FILTER_OPTIONS Dsmcc;
    BOOL  fSpecifyAtscOptions;      // If true, Atsc should be set with desired filter options
    ATSC_FILTER_OPTIONS Atsc;
} MPEG2_FILTER;
// 124 BYTES


typedef struct
{
    //union
    //{
    //    struct
    //    {
    //        BYTE  bVersionNumber;
    //        WORD  wFilterSize;
    //        BOOL  fUseRawFilteringBits;

    //        BYTE  Filter[16];
    //        BYTE  Mask[16];

    //        BOOL  fSpecifyTableIdExtension;
    //        WORD  TableIdExtension;
    //        BOOL  fSpecifyVersion;
    //        BYTE  Version;
    //        BOOL  fSpecifySectionNumber;
    //        BYTE  SectionNumber;
    //        BOOL  fSpecifyCurrentNext;
    //        BOOL  fNext;
    //        BOOL  fSpecifyDsmccOptions;
    //        DSMCC_FILTER_OPTIONS Dsmcc;
    //        BOOL  fSpecifyAtscOptions;
    //        ATSC_FILTER_OPTIONS Atsc;
    //    };
    //    BYTE bVersion1Bytes[124];
    //};
    MPEG2_FILTER bVersion1Bytes;
    // Version 1 - 124 bytes

    BOOL  fSpecifyDvbEitOptions;    // Set true for DVB/ISDB EIT. The table is handled segment basis.
    // If true, DvbEit should be set with desired filter options
    DVB_EIT_FILTER_OPTIONS DvbEit;
    // Version 2 - 133 bytes
} MPEG2_FILTER2;

//cpp_quote("#define MPEG2_FILTER_VERSION_1_SIZE  124")
//cpp_quote("#define MPEG2_FILTER_VERSION_2_SIZE  133")


//
// Mpeg-2 Stream buffer structure
//

typedef struct
{
    HRESULT hr;
    DWORD   dwDataBufferSize;
    DWORD   dwSizeOfDataRead;
    LongPtr pDataBuffer;
} MPEG_STREAM_BUFFER;



//
// MPEG-2 Time and Date structures
//

typedef struct
{
    BYTE Hours;     // Legal Range: 0 to 23
    BYTE Minutes;   // Legal Range: 0 to 59
    BYTE Seconds;   // Legal Range: 0 to 59
} MPEG_TIME;

typedef [public] MPEG_TIME MPEG_DURATION;

typedef struct
{
    BYTE Date;      // Legal Range: 1 to 31
    BYTE Month;     // Legal Range: 1 to 12
    WORD Year;      // Legal Range: 1900 to 2100 
} MPEG_DATE;

typedef struct
{
    MPEG_DATE D;
    MPEG_TIME T;
} MPEG_DATE_AND_TIME;



//
// MPEG-2 API Context structures
//

typedef enum
{
    MPEG_CONTEXT_BCS_DEMUX,
    MPEG_CONTEXT_WINSOCK
} MPEG_CONTEXT_TYPE;

typedef struct
{
    DWORD AVMGraphId;
} MPEG_BCS_DEMUX;

typedef struct
{
    DWORD AVMGraphId;
} MPEG_WINSOCK;


typedef struct
{
    MPEG_CONTEXT_TYPE Type;
    //union
    //{
    //    MPEG_BCS_DEMUX      Demux;
    //    MPEG_WINSOCK        Winsock;
    //} U;
    DWORD U;
} MPEG_CONTEXT;



//
// MPEG-2 Service Request and Responses
//

typedef enum
{
    MPEG_RQST_UNKNOWN = 0,
    MPEG_RQST_GET_SECTION,
    MPEG_RQST_GET_SECTION_ASYNC,
    MPEG_RQST_GET_TABLE,
    MPEG_RQST_GET_TABLE_ASYNC,
    MPEG_RQST_GET_SECTIONS_STREAM,
    MPEG_RQST_GET_PES_STREAM,
    MPEG_RQST_GET_TS_STREAM,
    MPEG_RQST_START_MPE_STREAM,
} MPEG_REQUEST_TYPE;

typedef struct
{
    MPEG_REQUEST_TYPE       Type;
    MPEG_CONTEXT            Context;
    PID                     Pid;
    TID                     TableId;
    MPEG2_FILTER            Filter;
    DWORD                   Flags;
} MPEG_SERVICE_REQUEST;

typedef struct
{
    DWORD                   IPAddress;
    WORD                    Port;
} MPEG_SERVICE_RESPONSE;



//
// DSM-CC & MPE Query Results
//

typedef struct _DSMCC_ELEMENT
{
    PID                     pid;
    BYTE                    bComponentTag;
    DWORD                   dwCarouselId;
    DWORD                   dwTransactionId;
    LongPtr pNext;
} DSMCC_ELEMENT;

typedef struct _MPE_ELEMENT
{
    PID                     pid;
    BYTE                    bComponentTag;
    LongPtr pNext;
} MPE_ELEMENT;



//
// MPEG-2 Stream Filtering Structure
//

typedef struct _MPEG_STREAM_FILTER
{
    WORD   wPidValue;               // PID value
    DWORD  dwFilterSize;            // size of filter in bits
    BOOL   fCrcEnabled;             // enable/disable CRC check 
    BYTE   rgchFilter[16];          // filter data
    BYTE   rgchMask[16];            // filter mask
} MPEG_STREAM_FILTER;

// This indicates whether the target machine is big endian or little endian
//cpp_quote("#undef BIG_ENDIAN_MACHINE")
//cpp_quote("#define LITTLE_ENDIAN_MACHINE")
//cpp_quote("")
//
//// Memory byte swap macros to preparse MPEG packets
//cpp_quote("#define XCHG(x)             MAKEWORD(HIBYTE(x), LOBYTE(x))")
//cpp_quote("#define DXCHG(x)            MAKELONG(XCHG(HIWORD(x)), XCHG(LOWORD(x)))")
//cpp_quote("")
//
//// Only swap bytes from network order on little endian machines
//cpp_quote("#undef SWAPBYTES")
//cpp_quote("#undef SWAPWORDS")
//cpp_quote("")
//
//cpp_quote("#ifdef LITTLE_ENDIAN_MACHINE")
//cpp_quote("#define SWAPBYTES(w)        ((w) = XCHG(w))")
//cpp_quote("#define SWAPWORDS(d)        ((d) = DXCHG(d))")
//cpp_quote("#endif")
//cpp_quote("")
//
//cpp_quote("#ifdef BIG_ENDIAN_MACHINE")
//cpp_quote("#define SWAPBYTES(w)        (w)")
//cpp_quote("#define SWAPWORDS(d)        (d)")
//cpp_quote("#endif")
//cpp_quote("")
//
//// Swap the header bytes of an MPEG-2 section
//cpp_quote("#define SWAP_MPEG_SECTION_HEADER_BYTES(_pSection)                                   \\")
//cpp_quote("    {                                                                       \\")
//cpp_quote("        if (_pSection)                                                      \\")
//cpp_quote("        {                                                                   \\")
//cpp_quote("            SWAPBYTES((_pSection)->Header.W);                                 \\")
//cpp_quote("                                                                            \\")
//cpp_quote("            if (reinterpret_cast<PMPEG_HEADER_BITS>(&((reinterpret_cast<PLONG_SECTION>(_pSection)->Header.W)))->SectionSyntaxIndicator || \\")
//cpp_quote("                    (_pSection)->TableId == 0x00 ||                           \\") // pmt tsid is same size/location as table id extension
//cpp_quote("                    (_pSection)->TableId == 0x3A ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3B ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3C ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3D ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3E)                             \\")
//cpp_quote("            {                                                               \\")
//cpp_quote("                SWAPBYTES(reinterpret_cast<PLONG_SECTION>(_pSection)->TableIdExtension);    \\")
//cpp_quote("            }                                                               \\")
//cpp_quote("        }                                                                   \\")
//cpp_quote("    }")
//cpp_quote("")
//cpp_quote("#define SWAP_MPEG_HEADER_BYTES(_pSection)                                   \\")
//cpp_quote("    {                                                                       \\")
//cpp_quote("        if (_pSection)                                                      \\")
//cpp_quote("        {                                                                   \\")
//cpp_quote("            SWAP_MPEG_SECTION_HEADER_BYTES(_pSection)                       \\")
//cpp_quote("            if ((_pSection)->TableId == 0x3B ||                             \\")
//cpp_quote("                (_pSection)->TableId == 0x3C)                               \\")
//cpp_quote("            {                                                               \\")
//cpp_quote("                SWAPBYTES(reinterpret_cast<PDSMCC_SECTION>(_pSection)->MessageId);          \\")
//cpp_quote("                SWAPWORDS(reinterpret_cast<PDSMCC_SECTION>(_pSection)->TransactionId);      \\")
//cpp_quote("                SWAPBYTES(reinterpret_cast<PDSMCC_SECTION>(_pSection)->MessageLength);      \\")
//cpp_quote("            }                                                               \\")
//cpp_quote("        }                                                                   \\")
//cpp_quote("    }")
//cpp_quote("")
//
//// Unswap the header bytes of an MPEG-2 section
//cpp_quote("#define UNSWAP_MPEG_HEADER_BYTES(_pSection)                                 \\")
//cpp_quote("    {                                                                       \\")
//cpp_quote("        if (_pSection)                                                      \\")
//cpp_quote("        {                                                                   \\")
//cpp_quote("            if ((_pSection)->TableId == 0x3B ||                             \\")
//cpp_quote("                (_pSection)->TableId == 0x3C)                               \\")
//cpp_quote("            {                                                               \\")
//cpp_quote("                SWAPBYTES((reinterpret_cast<PDSMCC_SECTION>(_pSection))->MessageId);          \\")
//cpp_quote("                SWAPWORDS((reinterpret_cast<PDSMCC_SECTION>(_pSection))->TransactionId);      \\")
//cpp_quote("                SWAPBYTES((reinterpret_cast<PDSMCC_SECTION>(_pSection))->MessageLength);      \\")
//cpp_quote("            }                                                                                 \\")
//cpp_quote("            UNSWAP_MPEG_SECTION_HEADER_BYTES(_pSection)                       \\")
//cpp_quote("        }                                                                     \\")
//cpp_quote("    }")
//cpp_quote("")
//cpp_quote("#define UNSWAP_MPEG_SECTION_HEADER_BYTES(_pSection)                         \\")
//cpp_quote("    {                                                                       \\")
//cpp_quote("        if (_pSection)                                                      \\")
//cpp_quote("        {                                                                   \\")
//cpp_quote("            if (reinterpret_cast<PMPEG_HEADER_BITS>(&((reinterpret_cast<PLONG_SECTION>(_pSection)->Header.W)))->SectionSyntaxIndicator || \\")
//cpp_quote("                    (_pSection)->TableId == 0x00 ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3A ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3B ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3C ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3D ||                           \\")
//cpp_quote("                    (_pSection)->TableId == 0x3E)                             \\")
//cpp_quote("            {                                                                 \\")
//cpp_quote("                SWAPBYTES(reinterpret_cast<PLONG_SECTION>(_pSection)->TableIdExtension);    \\")
//cpp_quote("            }                                                                               \\")
//cpp_quote("            SWAPBYTES(reinterpret_cast<PLONG_SECTION>(_pSection)->Header.W);                \\")
//cpp_quote("        }                                                                                   \\")
//cpp_quote("    }")
//cpp_quote("")

#pragma pack(pop)

 

//mpeg2data.h/.idl'



typedef enum DShowMpeg2DefTID
{
    MPEG_PAT_TID = 0x00,

    MPEG_CAT_TID = 0x01,
    MPEG_PMT_TID = 0x02,

    MPEG_TSDT_TID = 0x03,

    ATSC_MGT_TID = 0xC7,

    ATSC_VCT_TERR_TID = 0xC8,
    ATSC_VCT_CABL_TID = 0xC9,
    ATSC_EIT_TID = 0xCB,
    ATSC_ETT_TID = 0xCC,
    ATSC_RRT_TID = 0xCA,


    ATSC_STT_TID = 0xCD,
    ATSC_PIT_TID = 0xD0,

    DVB_NIT_ACTUAL_TID = 0x40,
    DVB_NIT_OTHER_TID = 0x41,

    DVB_SDT_ACTUAL_TID = 0x42,
    DVB_SDT_OTHER_TID = 0x46,

    DVB_BAT_TID = 0x4A,

    DVB_EIT_ACTUAL_TID = 0x4E,
    DVB_EIT_OTHER_TID = 0x4F,

    DVB_RST_TID = 0x71,

    DVB_TDT_TID = 0x70,
    DVB_ST_PID_16 = 0x0010,
    DVB_ST_PID_17 = 0x0011,
    DVB_ST_PID_18 = 0x0012,
    DVB_ST_PID_19 = 0x0013,
    DVB_ST_PID_20 = 0x0014,
    DVB_ST_TID = 0x72,
    ISDB_ST_TID = 0x72,

    DVB_TOT_TID = 0x73,

    DVB_DIT_TID = 0x7E,

    DVB_SIT_TID = 0x7F,
    ISDB_EMM_TID = 0x85,

    ISDB_BIT_TID = 0xC4,

    ISDB_NBIT_MSG_TID = 0xC5,
    ISDB_NBIT_REF_TID = 0xC6,

    ISDB_LDT_TID = 0xC7,


    ISDB_SDTT_TID = 0xC3,

    ISDB_CDT_TID = 0xC8,
    SCTE_EAS_TID = 0xD8,
} DShowMpeg2DefTID;

typedef enum DShowMpeg2DefPID
{
    MPEG_PAT_PID = 0x0000,

    MPEG_CAT_PID = 0x0001,


    MPEG_TSDT_PID = 0x0002,

    ATSC_MGT_PID = 0x1FFB,

    ATSC_VCT_PID = 0x1FFB,
    ATSC_RRT_PID = 0x1FFB,
    ATSC_STT_PID = 0x1FFB,
    DVB_NIT_PID = 0x0010,
    DVB_SDT_PID = 0x0011,
    DVB_BAT_PID = 0x0011,
    DVB_EIT_PID = 0x0012,
    DVB_RST_PID = 0x0013,
    DVB_TDT_PID = 0x0014,
    DVB_ST_PID_16 = 0x0010,
    DVB_ST_PID_17 = 0x0011,
    DVB_ST_PID_18 = 0x0012,
    DVB_ST_PID_19 = 0x0013,
    DVB_ST_PID_20 = 0x0014,
    DVB_TOT_PID = 0x0014,
    DVB_DIT_PID = 0x001E,
    DVB_SIT_PID = 0x001F,
    ISDB_BIT_PID = 0x0024,
    ISDB_NBIT_PID = 0x0025,
    ISDB_LDT_PID = 0x0025,
    ISDB_SDTT_PID = 0x0023,
    ISDB_SDTT_ALT_PID = 0x0028,
    ISDB_CDT_PID = 0x0029,
    SCTE_EAS_IB_PID = 0x1FFB,
    SCTE_EAS_OOB_PID = 0x1FFC
} DShowMpeg2DefPID;

typedef struct Mpeg2TableSampleHdr
{
    BYTE SectionCount;
    BYTE Reserved[3];
    long SectionOffsets[1];
}     Mpeg2TableSampleHdr;




[
    odl,
        uuid(BDCDD913-9ECD-4fb2-81AE-ADF747EA75A5)
]
interface IMpeg2TableFilter : stdole.IUnknown
{
    HRESULT AddPID([in] PID p);
    HRESULT AddTable([in] PID p, [in] TID t);
    HRESULT AddExtension([in] PID p, [in] TID t, [in] TEID e);
    HRESULT RemovePID([in] PID p);
    HRESULT RemoveTable([in] PID p, [in] TID t);
    HRESULT RemoveExtension([in] PID p, [in] TID t, [in] TEID e);
};

interface ISectionList;
interface IMpeg2Stream;

[
    odl,
        uuid(9B396D40-F380-4e3c-A514-1A82BF6EBFE6)
]
interface IMpeg2Data : stdole.IUnknown
{
    HRESULT GetSection([in]  PID                      pid,
        [in]  TID                      tid,
        [in]  MPEG2_FILTER*            pFilter,            // OPTIONAL
        [in]  DWORD                    dwTimeout,
        [out] ISectionList** ppSectionList);

    HRESULT GetTable([in]  PID                        pid,
        [in]  TID                        tid,
        [in]  MPEG2_FILTER*              pFilter,            // OPTIONAL
        [in]  DWORD                      dwTimeout,
        [out] ISectionList** ppSectionList);

    HRESULT GetStreamOfSections([in]  PID             pid,
        [in]  TID             tid,
        [in]  MPEG2_FILTER*   pFilter,            // OPTIONAL
        [in] LongPtr         hDataReadyEvent,
        [out] IMpeg2Stream** ppMpegStream);
};



////////////////////////////////////
//
// ISectionList Interface
//
////////////////////////////////////

[
    odl,
        uuid(AFEC1EB5-2A64-46c6-BF4B-AE3CCB6AFDB0)
]
interface ISectionList : stdole.IUnknown
{
    HRESULT Initialize([in]  MPEG_REQUEST_TYPE requestType,
        [in]  IMpeg2Data* pMpeg2Data,
        [in]   MPEG_CONTEXT*     pContext,
        [in]  PID               pid,
        [in]  TID               tid,
        [in]   MPEG2_FILTER* pFilter,                   // OPTIONAL
        [in]  DWORD             timeout,
        [in] LongPtr           hDoneEvent);               // OPTIONAL

    HRESULT InitializeWithRawSections([in]  MPEG_PACKET_LIST* pmplSections);

    HRESULT CancelPendingRequest(void);

    HRESULT GetNumberOfSections([out] WORD* pCount);

    HRESULT GetSectionData([in]  WORD          sectionNumber,
        [out] DWORD* pdwRawPacketLength,
        [out] LongPtr* ppSection);

    HRESULT GetProgramIdentifier([out] PID* pPid);

    HRESULT GetTableIdentifier([out] TID* pTableId);
};



////////////////////////////////////
//
// IMpeg2Stream Interface
//
////////////////////////////////////

[
    odl,
        uuid(400CC286-32A0-4ce4-9041-39571125A635)
]
interface IMpeg2Stream : stdole.IUnknown
{
    HRESULT Initialize([in]  MPEG_REQUEST_TYPE         requestType,
        [in]  IMpeg2Data* pMpeg2Data,
        [in]   MPEG_CONTEXT* pContext,
        [in]  PID                       pid,
        [in]  TID                       tid,
        [in]  MPEG2_FILTER* pFilter,           // OPTIONAL
        [in] LongPtr                   hDataReadyEvent);

    HRESULT SupplyDataBuffer([in]  MPEG_STREAM_BUFFER* pStreamBuffer);
};



////////////////////////////////////
//
// SectionList CoClass
//
////////////////////////////////////

[
    uuid(73DA5D04-4347-45d3-A9DC-FAE9DDBE558D)
]
coclass SectionList
{
    [default] interface ISectionList;
};



////////////////////////////////////
//
// Mpeg2Stream CoClass
//
////////////////////////////////////

[
    uuid(F91D96C7-8509-4d0b-AB26-A0DD10904BB7)
]
coclass Mpeg2Stream
{
    [default] interface IMpeg2Stream;
};



////////////////////////////////////
//
// Mpeg2Data CoClass
//
////////////////////////////////////

[
    uuid(C666E115-BB62-4027-A113-82D643FE2D99)
]
coclass Mpeg2Data
{
    [default] interface IMpeg2Data;
};


//cpp_quote("// {752845F1-758F-4c83-A043-4270C593308E}")
//cpp_quote("DEFINE_GUID(CLSID_Mpeg2TableFilter,")
//cpp_quote("0x752845f1, 0x758f, 0x4c83, 0xa0, 0x43, 0x42, 0x70, 0xc5, 0x93, 0x30, 0x8e);")
//
//
//////////////////////////////////////
////
//// Mpeg2DataLib Library
////
//////////////////////////////////////
//
//cpp_quote("#ifdef __cplusplus")
//cpp_quote("class DECLSPEC_UUID(\"DBAF6C1B-B6A4-4898-AE65-204F0D9509A1\") Mpeg2DataLib;")
//cpp_quote("#endif")






//mpeg2p siparser,h
//interface ISectionList;
//interface IMpeg2Data;



////////////////////////////////////
//
// IGenericDescriptor Interface
//
////////////////////////////////////

[
    odl,
        uuid(6A5918F8-A77A-4f61-AED0-5702BDCDA3E6)
]
interface IGenericDescriptor : stdole.IUnknown
{
    HRESULT Initialize([in]  BYTE* pbDesc,
        [in]  INT   bCount);

    HRESULT GetTag([out] BYTE* pbVal);

    HRESULT GetLength([out] BYTE* pbVal);

    HRESULT GetBody([out] LongPtr* ppbVal);
};


////////////////////////////////////
//
// IGenericDescriptor2 Interface mainly for PBDA with 16-bit descriptor length
//
////////////////////////////////////

[
    odl,
        uuid(BF02FB7E-9792-4e10-A68D-033A2CC246A5)
]
interface IGenericDescriptor2 : IGenericDescriptor
{
    HRESULT Initialize([in]  BYTE* pbDesc,
        [in]  WORD wCount);

    HRESULT GetLength([out] WORD* pwVal);

};

////////////////////////////////////
//
// IPAT Interface
//
////////////////////////////////////

[
    odl,
        uuid(6623B511-4B5F-43c3-9A01-E8FF84188060)
]
interface IPAT : stdole.IUnknown
{
    typedef struct
    {
        WORD    wProgramNumber;
        WORD    wProgramMapPID;
    } DShowBDAProgramElement;

    HRESULT Initialize([in]  ISectionList* pSectionList,
        [in]  IMpeg2Data* pMPEGData);

    HRESULT GetTransportStreamId([out] WORD* pwVal);

    HRESULT GetVersionNumber([out] BYTE* pbVal);

    HRESULT GetCountOfRecords([out] DWORD* pdwVal);

    HRESULT GetRecordProgramNumber([in]  DWORD  dwIndex,
        [out] WORD* pwVal);

    HRESULT GetRecordProgramMapPid([in]  DWORD  dwIndex,
        [out] WORD* pwVal);

    HRESULT FindRecordProgramMapPid([in]  WORD   wProgramNumber,
        [out] WORD* pwVal);

    HRESULT RegisterForNextTable([in] LongPtr hNextTableAvailable);

    HRESULT GetNextTable([out] IPAT** ppPAT);

    HRESULT RegisterForWhenCurrent([in] LongPtr hNextTableIsCurrent);

    HRESULT ConvertNextToCurrent(void);
};



////////////////////////////////////
//
// ICAT Interface
//
////////////////////////////////////

[
    odl,
        uuid(7C6995FB-2A31-4bd7-953E-B1AD7FB7D31C)
]
interface ICAT : stdole.IUnknown
{
    HRESULT Initialize([in]  ISectionList* pSectionList,
        [in]  IMpeg2Data* pMPEGData);

    HRESULT GetVersionNumber([out] BYTE* pbVal);

    HRESULT GetCountOfTableDescriptors([out] DWORD* pdwVal);

    HRESULT GetTableDescriptorByIndex([in]  DWORD                 dwIndex,
        [out] IGenericDescriptor** ppDescriptor);

    HRESULT GetTableDescriptorByTag([in]      BYTE                  bTag,
        [in, out] DWORD* pdwCookie, // OPTIONAL
        [out]     IGenericDescriptor** ppDescriptor);

    HRESULT RegisterForNextTable([in]  LongPtr hNextTableAvailable);

    HRESULT GetNextTable([in]  DWORD   dwTimeout,
        [out] ICAT** ppCAT);

    HRESULT RegisterForWhenCurrent([in]  LongPtr hNextTableIsCurrent);

    HRESULT ConvertNextToCurrent(void);
};



////////////////////////////////////
//
// IPMT Interface
//
////////////////////////////////////

[
    odl,
        uuid(01F3B398-9527-4736-94DB-5195878E97A8)
]
interface IPMT : stdole.IUnknown
{
    HRESULT Initialize([in]  ISectionList* pSectionList,
        [in]  IMpeg2Data* pMPEGData);

    HRESULT GetProgramNumber([out] WORD* pwVal);

    HRESULT GetVersionNumber([out] BYTE* pbVal);

    HRESULT GetPcrPid([out] PID* pPidVal);

    HRESULT GetCountOfTableDescriptors([out] DWORD* pdwVal);

    HRESULT GetTableDescriptorByIndex([in]  DWORD                 dwIndex,
        [out] IGenericDescriptor** ppDescriptor);

    HRESULT GetTableDescriptorByTag([in]      BYTE                  bTag,
        [in, out] DWORD* pdwCookie, // OPTIONAL
        [out]     IGenericDescriptor** ppDescriptor);

    HRESULT GetCountOfRecords([out] WORD* pwVal);

    HRESULT GetRecordStreamType([in]  DWORD  dwRecordIndex,
        [out] BYTE* pbVal);

    HRESULT GetRecordElementaryPid([in]  DWORD dwRecordIndex,
        [out] PID* pPidVal);

    HRESULT GetRecordCountOfDescriptors([in]  DWORD   dwRecordIndex,
        [out] DWORD* pdwVal);

    HRESULT GetRecordDescriptorByIndex([in]  DWORD                 dwRecordIndex,
        [in]  DWORD                 dwDescIndex,
        [out] IGenericDescriptor** ppDescriptor);

    HRESULT GetRecordDescriptorByTag([in]      DWORD                 dwRecordIndex,
        [in]      BYTE                  bTag,
        [in, out] DWORD* pdwCookie, // OPTIONAL
        [out]     IGenericDescriptor** ppDescriptor);

    HRESULT QueryServiceGatewayInfo([out] DSMCC_ELEMENT** ppDSMCCList,
        [out] UINT* puiCount);

    HRESULT QueryMPEInfo([out] LongPtr* ppMPEList,
        [out] UINT* puiCount);

    HRESULT RegisterForNextTable([in]  LongPtr hNextTableAvailable);

    HRESULT GetNextTable([out] IPMT** ppPMT);

    HRESULT RegisterForWhenCurrent([in]  LongPtr hNextTableIsCurrent);

    HRESULT ConvertNextToCurrent(void);
};



////////////////////////////////////
//
// ITSDT Interface
//
////////////////////////////////////

[
    odl,
        uuid(D19BDB43-405B-4a7c-A791-C89110C33165)
]
interface ITSDT : stdole.IUnknown
{
    HRESULT Initialize([in]  ISectionList* pSectionList,
        [in]  IMpeg2Data* pMPEGData);

    HRESULT GetVersionNumber([out] BYTE* pbVal);

    HRESULT GetCountOfTableDescriptors([out] DWORD* pdwVal);

    HRESULT GetTableDescriptorByIndex([in]  DWORD                 dwIndex,
        [out] IGenericDescriptor** ppDescriptor);

    HRESULT GetTableDescriptorByTag([in]      BYTE                  bTag,
        [in, out] DWORD* pdwCookie, // OPTIONAL
        [out]     IGenericDescriptor** ppDescriptor);

    HRESULT RegisterForNextTable([in] LongPtr hNextTableAvailable);

    HRESULT GetNextTable([out] ITSDT** ppTSDT);

    HRESULT RegisterForWhenCurrent([in] LongPtr hNextTableIsCurrent);

    HRESULT ConvertNextToCurrent(void);
};

////////////////////////////////////
//
// IPSITables Interface
//
////////////////////////////////////
[
    odl,
        uuid(919F24C5-7B14-42ac-A4B0-2AE08DAF00AC)
]
interface IPSITables : stdole.IUnknown
{
    // The parameters are basically the ones from the event EVENTID_PSITable
    // defined in bdamedia.h
    // dwPara1 - TSID, ONID|TSID for DVB EIT
    // dwPara2 - TID|PID
    // dwPara3 - dwHashedVersion
    // dwPara4 - program number for PMT, Segment#|SID for DVB EIT, but not used for others
    HRESULT GetTable([in] DWORD dwTSID,
        [in] DWORD dwTID_PID,
        [in] DWORD dwHashedVer,
        [in] DWORD dwPara4,
        [out] IUnknown** ppIUnknown);

};








//atscpsipparser_h


typedef enum BDAATSCEtmLocs
{
    ATSC_ETM_LOCATION_NOT_PRESENT = 0x00,
    ATSC_ETM_LOCATION_IN_PTC_FOR_PSIP = 0x01,
    ATSC_ETM_LOCATION_IN_PTC_FOR_EVENT = 0x02,
    ATSC_ETM_LOCATION_RESERVED = 0x03
} BDAATSCEtmLocs;


interface IATSC_MGT;
interface IATSC_VCT;
interface IATSC_EIT;
interface IATSC_STT;
interface IATSC_ETT;
interface ISCTE_EAS;




[
    odl,
        uuid(B2C98995-5EB2-4fb1-B406-F3E8E2026A9A)
]
interface IAtscPsipParser : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] IUnknown * punkMpeg2Data);

                HRESULT GetPAT(
                    [out] IPAT** ppPAT);

                HRESULT GetCAT(
                    [in] DWORD dwTimeout,
                    [out] ICAT** ppCAT);

                HRESULT GetPMT(
                    [in] PID pid,
                    [in] WORD* pwProgramNumber,
                    [out] IPMT** ppPMT);

                HRESULT GetTSDT(
                    [out] ITSDT** ppTSDT);

                HRESULT GetMGT(
                    [out] IATSC_MGT** ppMGT);

                HRESULT GetVCT(
                    [in] TID tableId,
                    [in] BOOL fGetNextTable,
                    [out] IATSC_VCT** ppVCT);

                HRESULT GetEIT(
                    [in] PID pid,
                    [in] WORD* pwSourceId,
                    [in] DWORD dwTimeout,
                    [out] IATSC_EIT** ppEIT);

                HRESULT GetETT(
                    [in] PID pid,
                    [in] WORD* wSourceId,
                    [in] WORD* pwEventId,
                    [out] IATSC_ETT** ppETT);

                HRESULT GetSTT(
                    [out] IATSC_STT** ppSTT);

                HRESULT GetEAS(
                    [in] PID pid,
                    [out] ISCTE_EAS** ppEAS);

            };



[
    odl,
        uuid(8877dabd-c137-4073-97e3-779407a5d87a)
]
interface IATSC_MGT : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetVersionNumber(
                    [out] BYTE* pbVal);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetCountOfRecords(
                    [out] DWORD* pdwVal);

                HRESULT GetRecordType(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordTypePid(
                    [in] DWORD dwRecordIndex,
                    [out] PID* ppidVal);

                HRESULT GetRecordVersionNumber(
                    [in] DWORD dwRecordIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordCountOfDescriptors(
                    [in] DWORD dwRecordIndex,
                    [out] DWORD* pdwVal);

                HRESULT GetRecordDescriptorByIndex(
                    [in] DWORD dwRecordIndex,
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetRecordDescriptorByTag(
                    [in] DWORD dwRecordIndex,
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetCountOfTableDescriptors(
                    [in] DWORD* pdwVal);

                HRESULT GetTableDescriptorByIndex(
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetTableDescriptorByTag(
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

            };


[
    odl,
        uuid(26879a18-32f9-46c6-91f0-fb6479270e8c)
]
interface IATSC_VCT : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetVersionNumber(
                    [out] BYTE* pbVal);

                HRESULT GetTransportStreamId(
                    [out] WORD* pwVal);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetCountOfRecords(
                    [out] DWORD* pdwVal);

                HRESULT GetRecordName(
                    [in] DWORD dwRecordIndex,
                    [out] LPWSTR* pwsName);

                HRESULT GetRecordMajorChannelNumber(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordMinorChannelNumber(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordModulationMode(
                    [in] DWORD dwRecordIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordCarrierFrequency(
                    [in] DWORD dwRecordIndex,
                    [out] DWORD* pdwVal);

                HRESULT GetRecordTransportStreamId(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordProgramNumber(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordEtmLocation(
                    [in] DWORD dwRecordIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordIsAccessControlledBitSet(
                    [in] DWORD dwRecordIndex,
                    [out] BOOL* pfVal);

                HRESULT GetRecordIsHiddenBitSet(
                    [in] DWORD dwRecordIndex,
                    [out] BOOL* pfVal);

                HRESULT GetRecordIsPathSelectBitSet(
                    [in] DWORD dwRecordIndex,
                    [out] BOOL* pfVal);

                HRESULT GetRecordIsOutOfBandBitSet(
                    [in] DWORD dwRecordIndex,
                    [out] BOOL* pfVal);

                HRESULT GetRecordIsHideGuideBitSet(
                    [in] DWORD dwRecordIndex,
                    [out] BOOL* pfVal);

                HRESULT GetRecordServiceType(
                    [in] DWORD dwRecordIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordSourceId(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordCountOfDescriptors(
                    [in] DWORD dwRecordIndex,
                    [out] DWORD* pdwVal);

                HRESULT GetRecordDescriptorByIndex(
                    [in] DWORD dwRecordIndex,
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetRecordDescriptorByTag(
                    [in] DWORD dwRecordIndex,
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetCountOfTableDescriptors(
                    [in] DWORD* pdwVal);

                HRESULT GetTableDescriptorByIndex(
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetTableDescriptorByTag(
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

            };





[
    odl,
        uuid(d7c212d7-76a2-4b4b-aa56-846879a80096)
]
interface IATSC_EIT : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetVersionNumber(
                    [out] BYTE* pbVal);

                HRESULT GetSourceId(
                    [out] WORD* pwVal);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetCountOfRecords(
                    [out] DWORD* pdwVal);

                HRESULT GetRecordEventId(
                    [in] DWORD dwRecordIndex,
                    [out] WORD* pwVal);

                HRESULT GetRecordStartTime(
                    [in] DWORD dwRecordIndex,
                    [out] MPEG_DATE_AND_TIME* pmdtVal);

                HRESULT GetRecordEtmLocation(
                    [in] DWORD dwRecordIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordDuration(
                    [in] DWORD dwRecordIndex,
                    [out] MPEG_DURATION* pmdVal);

                HRESULT GetRecordTitleText(
                    [in] DWORD dwRecordIndex,
                    [out] DWORD* pdwLength,
                    [out] LongPtr* ppText);

                HRESULT GetRecordCountOfDescriptors(
                    [in] DWORD dwRecordIndex,
                    [out] DWORD* pdwVal);

                HRESULT GetRecordDescriptorByIndex(
                    [in] DWORD dwRecordIndex,
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetRecordDescriptorByTag(
                    [in] DWORD dwRecordIndex,
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

            };


[
    odl,
        uuid(5a142cc9-b8cf-4a86-a040-e9cadf3ef3e7)
]
interface IATSC_ETT : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetVersionNumber(
                    [out] BYTE* pbVal);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetEtmId(
                    [out] DWORD* pdwVal);

                HRESULT GetExtendedMessageText(
                    [out] DWORD* pdwLength,
                    [out] LongPtr* ppText);

            };




[
    odl,
        uuid(6bf42423-217d-4d6f-81e1-3a7b360ec896)
]
interface IATSC_STT : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetSystemTime(
                    [out] MPEG_DATE_AND_TIME* pmdtSystemTime);

                HRESULT GetGpsUtcOffset(
                    [out] BYTE* pbVal);

                HRESULT GetDaylightSavings(
                    [out] WORD* pwVal);

                HRESULT GetCountOfTableDescriptors(
                    [out] DWORD* pdwVal);

                HRESULT GetTableDescriptorByIndex(
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetTableDescriptorByTag(
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

            };



[
    odl,
        uuid(1FF544D6-161D-4fae-9FAA-4F9F492AE999)
]
interface ISCTE_EAS : stdole.IUnknown
            {
                HRESULT Initialize(
                    [in] ISectionList * pSectionList,
                    [in] IMpeg2Data * pMPEGData);

                HRESULT GetVersionNumber(
                    [out] BYTE* pbVal);

                HRESULT GetSequencyNumber(
                    [out] BYTE* pbVal);

                HRESULT GetProtocolVersion(
                    [out] BYTE* pbVal);

                HRESULT GetEASEventID(
                    [out] WORD* pwVal);

                HRESULT GetOriginatorCode(
                    [out] BYTE* pbVal);

                HRESULT GetEASEventCodeLen(
                    [out] BYTE* pbVal);

                HRESULT GetEASEventCode(
                    [out] BYTE* pbVal);

                HRESULT GetRawNatureOfActivationTextLen(
                    [out] BYTE* pbVal);

                HRESULT GetRawNatureOfActivationText(
                    [out] BYTE* pbVal);

                HRESULT GetNatureOfActivationText(
                    [in] BSTR bstrIS0639code,
                    [out] BSTR* pbstrString);

                HRESULT GetTimeRemaining(
                    [out] BYTE* pbVal);

                HRESULT GetStartTime(
                    [out] DWORD* pdwVal);

                HRESULT GetDuration(
                    [out] WORD* pwVal);

                HRESULT GetAlertPriority(
                    [out] BYTE* pbVal);

                HRESULT GetDetailsOOBSourceID(
                    [out] WORD* pwVal);

                HRESULT GetDetailsMajor(
                    [out] WORD* pwVal);

                HRESULT GetDetailsMinor(
                    [out] WORD* pwVal);

                HRESULT GetDetailsAudioOOBSourceID(
                    [out] WORD* pwVal);

                HRESULT GetAlertText(
                    [in] BSTR bstrIS0639code,
                    [out] BSTR* pbstrString);

                HRESULT GetRawAlertTextLen(
                    [out] WORD* pwVal);

                HRESULT GetRawAlertText(
                    [out] BYTE* pbVal);

                HRESULT GetLocationCount(
                    [out] BYTE* pbVal);

                HRESULT GetLocationCodes(
                    [in] BYTE bIndex,
                    [out] BYTE* pbState,
                    [out] BYTE* pbCountySubdivision,
                    [out] WORD* pwCounty);

                HRESULT GetExceptionCount(
                    [out] BYTE* pbVal);

                HRESULT GetExceptionService(
                    [in] BYTE bIndex,
                    [out] BYTE* pbIBRef,
                    [out] WORD* pwFirst,
                    [out] WORD* pwSecond);

                HRESULT GetCountOfTableDescriptors(
                    [out] DWORD* pdwVal);

                HRESULT GetTableDescriptorByIndex(
                    [in] DWORD dwIndex,
                    [out] IGenericDescriptor** ppDescriptor);

                HRESULT GetTableDescriptorByTag(
                    [in] BYTE bTag,
                    [in, out] DWORD* pdwCookie,
                    [out] IGenericDescriptor** ppDescriptor);

            };



[
    odl,
        uuid(FF76E60C-0283-43ea-BA32-B422238547EE)
]
interface IAtscContentAdvisoryDescriptor : stdole.IUnknown
            {
                HRESULT GetTag(
                    [out] BYTE * pbVal);

                HRESULT GetLength(
                    [out] BYTE* pbVal);

                HRESULT GetRatingRegionCount(
                    [out] BYTE* pbVal);

                HRESULT GetRecordRatingRegion(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordRatedDimensions(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetRecordRatingDimension(
                    [in] BYTE bIndexOuter,
                    [in] BYTE bIndexInner,
                    [out] BYTE* pbVal);

                HRESULT GetRecordRatingValue(
                    [in] BYTE bIndexOuter,
                    [in] BYTE bIndexInner,
                    [out] BYTE* pbVal);

                HRESULT GetRecordRatingDescriptionText(
                    [in] BYTE bIndex,
                    [out] BYTE* pbLength,
                    [out] LongPtr* ppText);

            };



[
    odl,
        uuid(40834007-6834-46f0-BD45-D5F6A6BE258C)
]
interface ICaptionServiceDescriptor : stdole.IUnknown
            {
                HRESULT GetNumberOfServices(
                    [out] BYTE * pbVal);

                HRESULT GetLanguageCode(
                    [in] BYTE bIndex,
                    [out] BYTE* LangCode);

                HRESULT GetCaptionServiceNumber(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetCCType(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetEasyReader(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetWideAspectRatio(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

            };


[
    odl,
        uuid(58C3C827-9D91-4215-BFF3-820A49F0904C)
]
interface IServiceLocationDescriptor : stdole.IUnknown
            {
                HRESULT GetPCR_PID(
                    [out] WORD * pwVal);

                HRESULT GetNumberOfElements(
                    [out] BYTE* pbVal);

                HRESULT GetElementStreamType(
                    [in] BYTE bIndex,
                    [out] BYTE* pbVal);

                HRESULT GetElementPID(
                    [in] BYTE bIndex,
                    [out] WORD* pwVal);

                HRESULT GetElementLanguageCode(
                    [in] BYTE bIndex,
                    [out] BYTE* LangCode);

            };




